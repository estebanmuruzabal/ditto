{"ast":null,"code":"var _jsxFileName = \"/Users/estebanmuruzabal/work/Mahdi-Fashion/client/packages/shop/src/contexts/cart/use-cart.tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useReducer, useContext, createContext } from 'react';\nimport { reducer, cartItemsTotalPrice, cartDiscountAmount } from './cart.reducer';\nimport { useStorage } from 'utils/use-storage';\nconst CartContext = createContext({});\nconst INITIAL_STATE = {\n  isOpen: false,\n  items: [],\n  isRestaurant: false,\n  coupon: null,\n  noMoreStock: false\n};\n\nconst useCartActions = (initialCart = INITIAL_STATE) => {\n  var _state$items3;\n\n  const {\n    0: state,\n    1: dispatch\n  } = useReducer(reducer, initialCart);\n\n  const addItemHandler = (item, quantity = 1) => {\n    const product = state.items.map(cartItem => {\n      console.log(cartItem.id === item.id);\n    });\n\n    if (product.quantity === product.product_quantity) {\n      dispatch({\n        type: 'NO_MORE_STOCK'\n      });\n    } else {\n      dispatch({\n        type: 'ADD_ITEM',\n        payload: _objectSpread(_objectSpread({}, item), {}, {\n          quantity\n        })\n      });\n    }\n  };\n\n  const resetNoMoreStockHandler = () => {\n    dispatch({\n      type: 'RESET_NO_MORE_STOCK'\n    });\n  };\n\n  const removeItemHandler = (item, quantity = 1) => {\n    dispatch({\n      type: 'REMOVE_ITEM',\n      payload: _objectSpread(_objectSpread({}, item), {}, {\n        quantity\n      })\n    });\n  };\n\n  const clearItemFromCartHandler = item => {\n    dispatch({\n      type: 'CLEAR_ITEM_FROM_CART',\n      payload: item\n    });\n  };\n\n  const clearCartHandler = () => {\n    dispatch({\n      type: 'CLEAR_CART'\n    });\n  };\n\n  const toggleCartHandler = () => {\n    dispatch({\n      type: 'TOGGLE_CART'\n    });\n  };\n\n  const couponHandler = coupon => {\n    dispatch({\n      type: 'APPLY_COUPON',\n      payload: coupon\n    });\n  };\n\n  const removeCouponHandler = () => {\n    dispatch({\n      type: 'REMOVE_COUPON'\n    });\n  };\n\n  const rehydrateLocalState = payload => {\n    dispatch({\n      type: 'REHYDRATE',\n      payload\n    });\n  };\n\n  const toggleRestaurant = () => {\n    dispatch({\n      type: 'TOGGLE_RESTAURANT'\n    });\n  };\n\n  const isInCartHandler = id => {\n    var _state$items;\n\n    return (_state$items = state.items) === null || _state$items === void 0 ? void 0 : _state$items.some(item => item.id === id);\n  };\n\n  const getItemHandler = id => {\n    var _state$items2;\n\n    return (_state$items2 = state.items) === null || _state$items2 === void 0 ? void 0 : _state$items2.find(item => item.id === id);\n  };\n\n  const getCartItemsPrice = () => cartItemsTotalPrice(state.items).toFixed(2);\n\n  const getCartItemsTotalPrice = () => cartItemsTotalPrice(state.items, state.coupon).toFixed(2);\n\n  const getDiscount = () => cartDiscountAmount(state.items, state.coupon).toFixed(2);\n\n  const getItemsCount = (_state$items3 = state.items) === null || _state$items3 === void 0 ? void 0 : _state$items3.reduce((acc, item) => acc + item.quantity, 0);\n  return {\n    state,\n    getItemsCount,\n    rehydrateLocalState,\n    addItemHandler,\n    removeItemHandler,\n    resetNoMoreStockHandler,\n    clearItemFromCartHandler,\n    clearCartHandler,\n    isInCartHandler,\n    getItemHandler,\n    toggleCartHandler,\n    getCartItemsTotalPrice,\n    getCartItemsPrice,\n    couponHandler,\n    removeCouponHandler,\n    getDiscount,\n    toggleRestaurant\n  };\n};\n\nexport const CartProvider = ({\n  children\n}) => {\n  var _state$items4;\n\n  const {\n    state,\n    rehydrateLocalState,\n    getItemsCount,\n    addItemHandler,\n    removeItemHandler,\n    clearItemFromCartHandler,\n    clearCartHandler,\n    isInCartHandler,\n    getItemHandler,\n    toggleCartHandler,\n    getCartItemsTotalPrice,\n    couponHandler,\n    removeCouponHandler,\n    getCartItemsPrice,\n    getDiscount,\n    toggleRestaurant\n  } = useCartActions();\n  const {\n    rehydrated,\n    error\n  } = useStorage(state, rehydrateLocalState);\n  return __jsx(CartContext.Provider, {\n    value: {\n      isOpen: state.isOpen,\n      noMoreStock: state.noMoreStock,\n      items: state.items,\n      coupon: state.coupon,\n      isRestaurant: state.isRestaurant,\n      cartItemsCount: (_state$items4 = state.items) === null || _state$items4 === void 0 ? void 0 : _state$items4.length,\n      itemsCount: getItemsCount,\n      addItem: addItemHandler,\n      removeItem: removeItemHandler,\n      removeItemFromCart: clearItemFromCartHandler,\n      clearCart: clearCartHandler,\n      isInCart: isInCartHandler,\n      getItem: getItemHandler,\n      toggleCart: toggleCartHandler,\n      calculatePrice: getCartItemsTotalPrice,\n      calculateSubTotalPrice: getCartItemsPrice,\n      applyCoupon: couponHandler,\n      removeCoupon: removeCouponHandler,\n      calculateDiscount: getDiscount,\n      toggleRestaurant\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 5\n    }\n  }, children);\n};\nexport const useCart = () => useContext(CartContext);","map":{"version":3,"sources":["/Users/estebanmuruzabal/work/Mahdi-Fashion/client/packages/shop/src/contexts/cart/use-cart.tsx"],"names":["React","useReducer","useContext","createContext","reducer","cartItemsTotalPrice","cartDiscountAmount","useStorage","CartContext","INITIAL_STATE","isOpen","items","isRestaurant","coupon","noMoreStock","useCartActions","initialCart","state","dispatch","addItemHandler","item","quantity","product","map","cartItem","console","log","id","product_quantity","type","payload","resetNoMoreStockHandler","removeItemHandler","clearItemFromCartHandler","clearCartHandler","toggleCartHandler","couponHandler","removeCouponHandler","rehydrateLocalState","toggleRestaurant","isInCartHandler","some","getItemHandler","find","getCartItemsPrice","toFixed","getCartItemsTotalPrice","getDiscount","getItemsCount","reduce","acc","CartProvider","children","rehydrated","error","cartItemsCount","length","itemsCount","addItem","removeItem","removeItemFromCart","clearCart","isInCart","getItem","toggleCart","calculatePrice","calculateSubTotalPrice","applyCoupon","removeCoupon","calculateDiscount","useCart"],"mappings":"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","sourcesContent":["import React, { useReducer, useContext, createContext } from 'react';\nimport { reducer, cartItemsTotalPrice, cartDiscountAmount } from './cart.reducer';\nimport { useStorage } from 'utils/use-storage';\nconst CartContext = createContext({} as any);\nconst INITIAL_STATE = {\n  isOpen: false,\n  items: [],\n  isRestaurant: false,\n  coupon: null,\n  noMoreStock: false\n};\n\nconst useCartActions = (initialCart = INITIAL_STATE) => {\n  const [state, dispatch] = useReducer(reducer, initialCart);\n\n  const addItemHandler = (item, quantity = 1) => {\n\n    const product = state.items.map((cartItem) => {\n      console.log(cartItem.id === item.id)\n    })\n    \n    if (product.quantity === product.product_quantity) {\n      dispatch({ type: 'NO_MORE_STOCK' });\n    } else {\n      dispatch({ type: 'ADD_ITEM', payload: { ...item, quantity } });\n    }\n  };\n\n  const resetNoMoreStockHandler = () => {\n    dispatch({ type: 'RESET_NO_MORE_STOCK' });\n  };\n\n  const removeItemHandler = (item, quantity = 1) => {\n    dispatch({ type: 'REMOVE_ITEM', payload: { ...item, quantity } });\n  };\n\n  const clearItemFromCartHandler = (item) => {\n    dispatch({ type: 'CLEAR_ITEM_FROM_CART', payload: item });\n  };\n\n  const clearCartHandler = () => {\n    dispatch({ type: 'CLEAR_CART' });\n  };\n  const toggleCartHandler = () => {\n    dispatch({ type: 'TOGGLE_CART' });\n  };\n  const couponHandler = (coupon) => {\n    dispatch({ type: 'APPLY_COUPON', payload: coupon });\n  };\n  const removeCouponHandler = () => {\n    dispatch({ type: 'REMOVE_COUPON' });\n  };\n  const rehydrateLocalState = (payload) => {\n    dispatch({ type: 'REHYDRATE', payload });\n  };\n  const toggleRestaurant = () => {\n    dispatch({ type: 'TOGGLE_RESTAURANT' });\n  };\n  const isInCartHandler = (id) => {\n    return state.items?.some((item) => item.id === id);\n  };\n  const getItemHandler = (id) => {\n    return state.items?.find((item) => item.id === id);\n  };\n  const getCartItemsPrice = () => cartItemsTotalPrice(state.items).toFixed(2);\n\n  const getCartItemsTotalPrice = () =>\n    cartItemsTotalPrice(state.items, state.coupon).toFixed(2);\n\n  const getDiscount = () => cartDiscountAmount(state.items, state.coupon).toFixed(2);\n\n  const getItemsCount = state.items?.reduce(\n    (acc, item) => acc + item.quantity,\n    0\n  );\n  return {\n    state,\n    getItemsCount,\n    rehydrateLocalState,\n    addItemHandler,\n    removeItemHandler,\n    resetNoMoreStockHandler,\n    clearItemFromCartHandler,\n    clearCartHandler,\n    isInCartHandler,\n    getItemHandler,\n    toggleCartHandler,\n    getCartItemsTotalPrice,\n    getCartItemsPrice,\n    couponHandler,\n    removeCouponHandler,\n    getDiscount,\n    toggleRestaurant,\n  };\n};\n\nexport const CartProvider = ({ children }) => {\n  const {\n    state,\n    rehydrateLocalState,\n    getItemsCount,\n    addItemHandler,\n    removeItemHandler,\n    clearItemFromCartHandler,\n    clearCartHandler,\n    isInCartHandler,\n    getItemHandler,\n    toggleCartHandler,\n    getCartItemsTotalPrice,\n    couponHandler,\n    removeCouponHandler,\n    getCartItemsPrice,\n    getDiscount,\n    toggleRestaurant,\n  } = useCartActions();\n  const { rehydrated, error } = useStorage(state, rehydrateLocalState);\n  return (\n    <CartContext.Provider\n      value={{\n        isOpen: state.isOpen,\n        noMoreStock: state.noMoreStock,\n        items: state.items,\n        coupon: state.coupon,\n        isRestaurant: state.isRestaurant,\n        cartItemsCount: state.items?.length,\n        itemsCount: getItemsCount,\n        addItem: addItemHandler,\n        removeItem: removeItemHandler,\n        removeItemFromCart: clearItemFromCartHandler,\n        clearCart: clearCartHandler,\n        isInCart: isInCartHandler,\n        getItem: getItemHandler,\n        toggleCart: toggleCartHandler,\n        calculatePrice: getCartItemsTotalPrice,\n        calculateSubTotalPrice: getCartItemsPrice,\n        applyCoupon: couponHandler,\n        removeCoupon: removeCouponHandler,\n        calculateDiscount: getDiscount,\n        toggleRestaurant,\n      }}\n    >\n      {children}\n    </CartContext.Provider>\n  );\n};\n\nexport const useCart = () => useContext(CartContext);\n"]},"metadata":{},"sourceType":"module"}