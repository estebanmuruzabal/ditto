{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/estebanmuruzabal/work/ditto/client/packages/shop/src/features/your-plants/your-plants.tsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useContext } from 'react';\nimport Link from 'next/link';\nimport { openModal } from '@redq/reuse-modal';\nimport { useMutation, useQuery } from '@apollo/react-hooks';\nimport { RelaysIds, SettingsNames } from 'utils/constant';\nimport ErrorMessage from 'components/error-message/error-message';\nimport { PlantsPageContainer, OrderDetails, BlockTitle, Text, ListItem, ListTitle, ListDes, ButtonText, PlantPageWrapper, PlantsWrapper, PlantsSensorContainer } from './your-plants.style';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { GET_LOGGED_IN_USER } from 'graphql/query/customer.query';\nimport { Button } from 'components/button/button';\nimport { ADD_PLANT, UPDATE_SETTING } from 'graphql/query/plants.query';\nimport { Input } from 'components/forms/input';\nimport { ProfileContext } from 'contexts/profile/profile.context';\nimport { SuccessMsg } from 'features/user-profile/settings/settings.style';\nimport SoilHumiditySensor from './sensors/SoilHumiditySensor';\nimport LightSensor from './sensors/LightSensor';\n\nvar YourPlants = function YourPlants(_ref) {\n  _s();\n\n  var deviceType = _ref.deviceType;\n\n  var _useContext = useContext(ProfileContext),\n      state = _useContext.state,\n      dispatch = _useContext.dispatch;\n\n  var _useQuery = useQuery(GET_LOGGED_IN_USER, {\n    pollInterval: 5000\n  }),\n      data = _useQuery.data,\n      error = _useQuery.error,\n      loading = _useQuery.loading,\n      userRefetch = _useQuery.refetch; // const router = useRouter();\n\n\n  var intl = useIntl();\n\n  var _useState = useState(''),\n      name = _useState[0],\n      setPlantName = _useState[1];\n\n  var _useState2 = useState(''),\n      openTab = _useState2[0],\n      setOpenTab = _useState2[1];\n\n  var _useState3 = useState(''),\n      plantId = _useState3[0],\n      setControllerID = _useState3[1];\n\n  var _useState4 = useState(''),\n      userinfoMsg = _useState4[0],\n      setUserinfoMsg = _useState4[1];\n\n  var _useMutation = useMutation(ADD_PLANT),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      addPlant = _useMutation2[0];\n\n  var _useMutation3 = useMutation(UPDATE_SETTING),\n      _useMutation4 = _slicedToArray(_useMutation3, 1),\n      updateSetting = _useMutation4[0];\n\n  var plants = state.plants;\n\n  if (loading) {\n    return __jsx(ErrorMessage, {\n      message: 'Cargando...',\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 12\n      }\n    });\n  }\n\n  ;\n\n  if (error) {\n    return __jsx(ErrorMessage, {\n      message: error.message,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 7\n      }\n    });\n  }\n\n  ;\n\n  var isRelayIdAlreadyAssigend = function isRelayIdAlreadyAssigend(plant, field) {\n    if (field !== 'relayOneIdRelated' && field !== 'relayTwoIdRelated' && field !== 'relayThreeIdRelated' && field !== 'relayFourIdRelated') return false;\n    {\n      Object.keys(SettingsNames).map(function (settingName, i) {\n        if (plant[settingName] && [field]) return;\n        var relaysIds = [RelaysIds.RELAY_ONE, RelaysIds.RELAY_TWO, RelaysIds.RELAY_THIRD, RelaysIds.RELAY_FOURTH];\n        var relayAlreadyAssigned = relaysIds.includes(plant[settingName][field]);\n\n        if (relayAlreadyAssigned) {\n          setUserinfoMsg(\"\".concat(intl.formatMessage({\n            id: 'relayAlreadyAssinged',\n            defaultMessage: 'Relay already assigned in '\n          }), \" \").concat(plant[settingName]));\n          setTimeout(function () {\n            setUserinfoMsg('');\n          }, 8000);\n          return true;\n        }\n      });\n    }\n    return false;\n  };\n\n  var handleSettingsChange = function handleSettingsChange(e, plant, field, value, settingName) {\n    if (isRelayIdAlreadyAssigend(plant, field)) return;\n    dispatch({\n      type: settingName,\n      payload: {\n        plant: plant,\n        value: value,\n        field: field\n      }\n    });\n    dispatchSettingSave(plant, field, value, settingName);\n    setUserinfoMsg('Update user info successfully');\n    setTimeout(function () {\n      setUserinfoMsg('');\n    }, 8000);\n  };\n\n  var handleAddClick = function handleAddClick() {\n    var _data$getUser;\n\n    addPlant({\n      variables: {\n        id: data === null || data === void 0 ? void 0 : (_data$getUser = data.getUser) === null || _data$getUser === void 0 ? void 0 : _data$getUser.id,\n        name: name,\n        plantId: Number(plantId)\n      }\n    });\n    setUserinfoMsg('Update user info successfully');\n    userRefetch();\n    setTimeout(function () {\n      setUserinfoMsg('');\n    }, 8000);\n  };\n\n  var onDeleteSchedule = function onDeleteSchedule(plant, settingName, position) {\n    var _data$getUser2;\n\n    delete plant[settingName][position];\n    updateSetting({\n      variables: {\n        id: data === null || data === void 0 ? void 0 : (_data$getUser2 = data.getUser) === null || _data$getUser2 === void 0 ? void 0 : _data$getUser2.id,\n        plantId: plant.plantId,\n        input: _objectSpread(_objectSpread({}, plant[settingName]), {}, {\n          settingName: settingName\n        })\n      }\n    });\n    setUserinfoMsg('Update user info successfully');\n    setTimeout(function () {\n      setUserinfoMsg('');\n    }, 8000);\n  };\n\n  var dispatchSettingSave = function dispatchSettingSave(plant, fieldName, fieldValue, settingName) {\n    var _data$getUser3;\n\n    updateSetting({\n      variables: {\n        id: data === null || data === void 0 ? void 0 : (_data$getUser3 = data.getUser) === null || _data$getUser3 === void 0 ? void 0 : _data$getUser3.id,\n        plantId: plant.plantId,\n        input: _objectSpread(_objectSpread(_defineProperty({}, fieldName, fieldValue), plant[settingName]), {}, {\n          settingName: settingName\n        })\n      }\n    });\n  }; // Add or edit modal\n\n\n  var handleModal = function handleModal(modalComponent) {\n    var modalProps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var className = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'add-time-schedule-modal';\n    openModal({\n      show: true,\n      config: {\n        width: 360,\n        height: 'auto',\n        enableResizing: false,\n        disableDragging: true,\n        className: className\n      },\n      closeOnClickOutside: true,\n      component: modalComponent,\n      componentProps: {\n        item: modalProps\n      }\n    });\n  };\n\n  var renderAirTemperatureSensor = function renderAirTemperatureSensor(plant, i) {\n    return __jsx(PlantsSensorContainer, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 7\n      }\n    }, __jsx(ListItem, {\n      style: {\n        justifyContent: 'flex-start'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }\n    }, __jsx(ListTitle, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 11\n      }\n    }, __jsx(Text, {\n      bold: true,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 13\n      }\n    }, __jsx(FormattedMessage, {\n      id: \"tempSensorId\",\n      defaultMessage: \"tempSensorId\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 15\n      }\n    }))), __jsx(ListDes, {\n      style: {\n        marginLeft: '10px'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 11\n      }\n    }, __jsx(Text, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 13\n      }\n    }, plant === null || plant === void 0 ? void 0 : plant.tempeture, \" \\xB0\"))));\n  };\n\n  var renderAirHumiditySensor = function renderAirHumiditySensor(plant, i) {\n    return __jsx(PlantsSensorContainer, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 7\n      }\n    }, __jsx(ListItem, {\n      style: {\n        justifyContent: 'flex-start'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }\n    }, __jsx(ListTitle, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 11\n      }\n    }, __jsx(Text, {\n      bold: true,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 13\n      }\n    }, __jsx(FormattedMessage, {\n      id: \"humedadAmbienteSensorId\",\n      defaultMessage: \"humedadAmbienteSensorId\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 15\n      }\n    }))), __jsx(ListDes, {\n      style: {\n        marginLeft: '10px'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 11\n      }\n    }, __jsx(Text, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 13\n      }\n    }, plant === null || plant === void 0 ? void 0 : plant.airHumidity, \" %\"))));\n  };\n\n  return __jsx(PlantPageWrapper, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 5\n    }\n  }, __jsx(PlantsPageContainer, {\n    style: {\n      width: '100%'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 7\n    }\n  }, __jsx(Link, {\n    href: \"/profile\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 9\n    }\n  }, __jsx(\"a\", {\n    className: \"home-btn\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 11\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"backProfileBtn\",\n    defaultMessage: \"Back to Profile\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 13\n    }\n  }))), __jsx(OrderDetails, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 9\n    }\n  }, __jsx(BlockTitle, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 11\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"yourPlants\",\n    defaultMessage: \"Your Plants\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 13\n    }\n  })), (plants === null || plants === void 0 ? void 0 : plants.length) < 1 && __jsx(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 36\n    }\n  }, \"No tienes plantas registradas\"), plants === null || plants === void 0 ? void 0 : plants.map(function (plant, i) {\n    return __jsx(PlantsWrapper, {\n      key: i + '-orderList',\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 17\n      }\n    }, __jsx(ListItem, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 19\n      }\n    }, __jsx(ListTitle, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 23\n      }\n    }, __jsx(Text, {\n      bold: true,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 25\n      }\n    }, __jsx(FormattedMessage, {\n      id: \"controllerNameId\",\n      defaultMessage: \"controllerNameId\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 27\n      }\n    }))), __jsx(ListDes, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 23\n      }\n    }, __jsx(Input, {\n      type: \"text\",\n      name: \"name\",\n      disabled: true,\n      value: (plant === null || plant === void 0 ? void 0 : plant.name) || '' // we have to change the onChange because the is no one for the controller name actualy\n      ,\n      onChange: function onChange(e) {\n        return handleSettingsChange(e, plant, 'name', e.target.value, SettingsNames.SOIL_HUMIDITY_SETTING_1);\n      },\n      backgroundColor: \"#F7F7F7\",\n      width: \"197px\",\n      height: \"34.5px\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 25\n      }\n    }))), __jsx(SoilHumiditySensor, {\n      data: data,\n      plant: plant,\n      openTab: openTab,\n      setOpenTab: setOpenTab,\n      settingName: SettingsNames.SOIL_HUMIDITY_SETTING_1,\n      handleSettingsChange: handleSettingsChange,\n      onDeleteSchedule: onDeleteSchedule,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 21\n      }\n    }), __jsx(SoilHumiditySensor, {\n      data: data,\n      plant: plant,\n      openTab: openTab,\n      setOpenTab: setOpenTab,\n      settingName: SettingsNames.SOIL_HUMIDITY_SETTING_2,\n      handleSettingsChange: handleSettingsChange,\n      onDeleteSchedule: onDeleteSchedule,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 21\n      }\n    }), __jsx(LightSensor, {\n      data: data,\n      plant: plant,\n      openTab: openTab,\n      setOpenTab: setOpenTab,\n      settingName: SettingsNames.LIGHT_SETTING,\n      handleSettingsChange: handleSettingsChange,\n      onDeleteSchedule: onDeleteSchedule,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 21\n      }\n    }), renderAirTemperatureSensor(plant, i), renderAirHumiditySensor(plant, i));\n  }), userinfoMsg && __jsx(SuccessMsg, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 15\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"userInfoSuccess\",\n    defaultMessage: userinfoMsg,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 17\n    }\n  })))), __jsx(PlantsPageContainer, {\n    style: {\n      width: '100%'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 7\n    }\n  }, __jsx(BlockTitle, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 9\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"addController\",\n    defaultMessage: \"Your Plants\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 11\n    }\n  })), __jsx(ListItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 9\n    }\n  }, __jsx(ListTitle, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 11\n    }\n  }, __jsx(Text, {\n    bold: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 13\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"plantNameField\",\n    defaultMessage: \"Name of the plant\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 15\n    }\n  }))), __jsx(ListDes, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 11\n    }\n  }, __jsx(Input, {\n    type: \"text\",\n    name: \"name\",\n    value: name,\n    onChange: function onChange(e) {\n      return setPlantName(e.target.value);\n    },\n    backgroundColor: \"#F7F7F7\",\n    width: \"197px\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 13\n    }\n  }))), __jsx(ListItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 9\n    }\n  }, __jsx(ListTitle, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 11\n    }\n  }, __jsx(Text, {\n    bold: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 13\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"plantIdField\",\n    defaultMessage: \"ID of the controller\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 15\n    }\n  }))), __jsx(ListDes, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 11\n    }\n  }, __jsx(Input, {\n    type: \"number\",\n    name: \"plantId\",\n    value: plantId,\n    onChange: function onChange(e) {\n      return setControllerID(e.target.value);\n    },\n    backgroundColor: \"#F7F7F7\",\n    width: \"197px\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 13\n    }\n  }))), __jsx(Button, {\n    className: \"cart-button\",\n    variant: \"secondary\",\n    borderRadius: 100,\n    onClick: handleAddClick,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 9\n    }\n  }, __jsx(ButtonText, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 11\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"addPlantButton\",\n    defaultMessage: \"Add plant\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 13\n    }\n  })))));\n};\n\n_s(YourPlants, \"pAi8+iSoIRVnOrlkVI3qvXHVTKA=\", false, function () {\n  return [useQuery, useIntl, useMutation, useMutation];\n});\n\n_c = YourPlants;\nexport default YourPlants;\n\nvar _c;\n\n$RefreshReg$(_c, \"YourPlants\");","map":{"version":3,"sources":["/Users/estebanmuruzabal/work/ditto/client/packages/shop/src/features/your-plants/your-plants.tsx"],"names":["React","useState","useContext","Link","openModal","useMutation","useQuery","RelaysIds","SettingsNames","ErrorMessage","PlantsPageContainer","OrderDetails","BlockTitle","Text","ListItem","ListTitle","ListDes","ButtonText","PlantPageWrapper","PlantsWrapper","PlantsSensorContainer","FormattedMessage","useIntl","GET_LOGGED_IN_USER","Button","ADD_PLANT","UPDATE_SETTING","Input","ProfileContext","SuccessMsg","SoilHumiditySensor","LightSensor","YourPlants","deviceType","state","dispatch","pollInterval","data","error","loading","userRefetch","refetch","intl","name","setPlantName","openTab","setOpenTab","plantId","setControllerID","userinfoMsg","setUserinfoMsg","addPlant","updateSetting","plants","message","isRelayIdAlreadyAssigend","plant","field","Object","keys","map","settingName","i","relaysIds","RELAY_ONE","RELAY_TWO","RELAY_THIRD","RELAY_FOURTH","relayAlreadyAssigned","includes","formatMessage","id","defaultMessage","setTimeout","handleSettingsChange","e","value","type","payload","dispatchSettingSave","handleAddClick","variables","getUser","Number","onDeleteSchedule","position","input","fieldName","fieldValue","handleModal","modalComponent","modalProps","className","show","config","width","height","enableResizing","disableDragging","closeOnClickOutside","component","componentProps","item","renderAirTemperatureSensor","justifyContent","marginLeft","tempeture","renderAirHumiditySensor","airHumidity","length","target","SOIL_HUMIDITY_SETTING_1","SOIL_HUMIDITY_SETTING_2","LIGHT_SETTING"],"mappings":"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","sourcesContent":["import React,  { useState, useEffect, useContext } from 'react';\nimport Link from 'next/link';\nimport { openModal } from '@redq/reuse-modal';\nimport { useMutation, useQuery } from '@apollo/react-hooks';\nimport { RelaysIds, SettingsNames } from 'utils/constant';\nimport ErrorMessage from 'components/error-message/error-message';\n\nimport {\n  PlantsPageContainer,\n  OrderDetails,\n  BlockTitle,\n  Text,\n  ListItem,\n  ListTitle,\n  ListDes,\n  ButtonText,\n  PlantPageWrapper,\n  PlantsWrapper,\n  PlantsSensorContainer\n} from './your-plants.style';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { GET_LOGGED_IN_USER } from 'graphql/query/customer.query';\nimport { Button } from 'components/button/button';\nimport { ADD_PLANT, UPDATE_SETTING } from 'graphql/query/plants.query';\nimport { Input } from 'components/forms/input';\nimport { ProfileContext } from 'contexts/profile/profile.context';\nimport { SuccessMsg } from 'features/user-profile/settings/settings.style';\nimport SoilHumiditySensor from './sensors/SoilHumiditySensor';\nimport LightSensor from './sensors/LightSensor';\n  \n\ntype YourPlantsProps = {\n  data?: any;\n  index?: Number;\n  Router?: any;\n  deviceType?: {\n    mobile: boolean;\n    tablet: boolean;\n    desktop: boolean;\n  };\n};\n\nconst YourPlants: React.FC<YourPlantsProps> = ({ deviceType }) => {\n  const { state, dispatch } = useContext(ProfileContext);\n  const { data, error, loading, refetch: userRefetch } = useQuery(GET_LOGGED_IN_USER, {\n    pollInterval: 5000,\n  });\n  // const router = useRouter();\n  const intl = useIntl();\n  const [name, setPlantName] = useState('');\n  const [openTab, setOpenTab] = useState('');\n  const [plantId, setControllerID] = useState('');\n  const [userinfoMsg, setUserinfoMsg] = useState('');\n  const [addPlant] = useMutation(ADD_PLANT);\n  \n  const [updateSetting] = useMutation(UPDATE_SETTING);\n  const { plants } = state;\n\n  if (loading) {\n    return <ErrorMessage message={'Cargando...'} />\n  };\n\n  if (error) {\n    return (\n      <ErrorMessage message={error.message} />\n    );\n  };\n\n  const isRelayIdAlreadyAssigend = (plant: any, field: string) => {\n    if (field !== 'relayOneIdRelated' && field !== 'relayTwoIdRelated' && field !== 'relayThreeIdRelated' && field !== 'relayFourIdRelated') return false;\n\n    {Object.keys(SettingsNames).map((settingName, i: number) => {\n      if (plant[settingName] && [field]) return;\n      const relaysIds = [RelaysIds.RELAY_ONE, RelaysIds.RELAY_TWO, RelaysIds.RELAY_THIRD, RelaysIds.RELAY_FOURTH];\n\n      const relayAlreadyAssigned = relaysIds.includes(plant[settingName][field]);\n\n      if (relayAlreadyAssigned) {\n        setUserinfoMsg(`${intl.formatMessage({ id: 'relayAlreadyAssinged', defaultMessage: 'Relay already assigned in ' })} ${plant[settingName]}`);\n        setTimeout(function () {\n          setUserinfoMsg('');\n        }, 8000)\n        return true;\n      }\n     })\n   }\n   return false;\n  };\n  \n\n  const handleSettingsChange = (e: any, plant: any, field: string, value: string | boolean, settingName: SettingsNames) => {\n    if (isRelayIdAlreadyAssigend(plant, field)) return;\n\n    dispatch({ type: settingName, payload: { plant, value, field } });\n\n    dispatchSettingSave(plant, field, value, settingName);\n\n    setUserinfoMsg('Update user info successfully');\n    setTimeout(function () {\n      setUserinfoMsg('');\n    }, 8000)\n  };\n  \n  const handleAddClick = () => {\n    addPlant({\n      variables: {\n        id: data?.getUser?.id,\n        name,\n        plantId: Number(plantId)\n      },\n    });\n\n    setUserinfoMsg('Update user info successfully');\n    userRefetch();\n    setTimeout(function () {\n      setUserinfoMsg('');\n    }, 8000)\n  };\n\n  const onDeleteSchedule = (plant: any, settingName: SettingsNames, position: number) => {\n    delete plant[settingName][position];\n    \n    updateSetting({\n      variables: {\n        id: data?.getUser?.id,\n        plantId: plant.plantId,\n        input: { ...plant[settingName], settingName: settingName }\n      },\n    });\n\n    setUserinfoMsg('Update user info successfully');\n    setTimeout(function () {\n      setUserinfoMsg('');\n    }, 8000)\n  };\n    \n  const dispatchSettingSave = (plant: any, fieldName: string, fieldValue: string | boolean, settingName: SettingsNames) => {\n    updateSetting({\n      variables: {\n        id: data?.getUser?.id,\n        plantId: plant.plantId,\n        input: { [fieldName]: fieldValue, ...plant[settingName], settingName: settingName }\n      },\n    });\n  };\n\n  // Add or edit modal\n  const handleModal = (\n    modalComponent: any,\n    modalProps = {},\n    className: string = 'add-time-schedule-modal'\n  ) => {\n    openModal({\n      show: true,\n      config: {\n        width: 360,\n        height: 'auto',\n        enableResizing: false,\n        disableDragging: true,\n        className: className,\n      },\n      closeOnClickOutside: true,\n      component: modalComponent,\n      componentProps: { item: modalProps },\n    });\n  };\n\n  const renderAirTemperatureSensor = (plant: any, i: any) => {\n    return (\n      <PlantsSensorContainer>\n        <ListItem style={{ justifyContent: 'flex-start' }}>\n          <ListTitle>\n            <Text bold>\n              <FormattedMessage\n                id=\"tempSensorId\"\n                defaultMessage=\"tempSensorId\"\n              />\n            </Text>\n          </ListTitle>\n          <ListDes style={{ marginLeft: '10px' }}>\n            <Text>{plant?.tempeture} °</Text>\n          </ListDes>\n        </ListItem>\n      </PlantsSensorContainer>\n    )\n  }\n\n  const renderAirHumiditySensor = (plant: any, i: any) => {\n    return (\n      <PlantsSensorContainer>\n        <ListItem style={{ justifyContent: 'flex-start' }}>\n          <ListTitle>\n            <Text bold>\n              <FormattedMessage\n                id=\"humedadAmbienteSensorId\"\n                defaultMessage=\"humedadAmbienteSensorId\"\n              />\n            </Text>\n          </ListTitle>\n          <ListDes style={{ marginLeft: '10px' }}>\n            <Text>{plant?.airHumidity} %</Text>\n          </ListDes>\n        </ListItem>\n      </PlantsSensorContainer>\n    )\n  }\n\n\n  return (\n    <PlantPageWrapper>\n      <PlantsPageContainer style={{ width: '100%' }}>\n        <Link href=\"/profile\">\n          <a className=\"home-btn\">\n            <FormattedMessage id=\"backProfileBtn\" defaultMessage=\"Back to Profile\" />\n          </a>\n        </Link>\n\n        <OrderDetails>\n          <BlockTitle>\n            <FormattedMessage\n              id=\"yourPlants\"\n              defaultMessage=\"Your Plants\"\n            />\n          </BlockTitle>\n\n          { plants?.length < 1 && (<Text>No tienes plantas registradas</Text>) }\n          { plants?.map((plant, i: number) => {\n              return (\n                <PlantsWrapper key={i + '-orderList'}>\n                  <ListItem>\n                      <ListTitle>\n                        <Text bold>\n                          <FormattedMessage\n                            id=\"controllerNameId\"\n                            defaultMessage=\"controllerNameId\"\n                          />\n                        </Text>\n                      </ListTitle>\n                      <ListDes>\n                        <Input\n                          type='text'\n                          name='name'\n                          disabled={true}\n                          value={plant?.name || ''}\n                          // we have to change the onChange because the is no one for the controller name actualy\n                          onChange={(e: any) => handleSettingsChange(e, plant, 'name', e.target.value, SettingsNames.SOIL_HUMIDITY_SETTING_1)}\n                          backgroundColor='#F7F7F7'\n                          width='197px'\n                          height='34.5px'\n                        />\n                      </ListDes>\n                    </ListItem>\n\n                    <SoilHumiditySensor \n                      data={data}\n                      plant={plant}\n                      openTab={openTab}\n                      setOpenTab={setOpenTab}\n                      settingName={SettingsNames.SOIL_HUMIDITY_SETTING_1}\n                      handleSettingsChange={handleSettingsChange}\n                      onDeleteSchedule={onDeleteSchedule} \n                    />\n                    <SoilHumiditySensor \n                      data={data}\n                      plant={plant}\n                      openTab={openTab}\n                      setOpenTab={setOpenTab}\n                      settingName={SettingsNames.SOIL_HUMIDITY_SETTING_2}\n                      handleSettingsChange={handleSettingsChange}\n                      onDeleteSchedule={onDeleteSchedule} \n                    />\n                    <LightSensor \n                      data={data}\n                      plant={plant}\n                      openTab={openTab}\n                      setOpenTab={setOpenTab}\n                      settingName={SettingsNames.LIGHT_SETTING}\n                      handleSettingsChange={handleSettingsChange}\n                      onDeleteSchedule={onDeleteSchedule} \n                    />\n                  {renderAirTemperatureSensor(plant, i)}\n                  {renderAirHumiditySensor(plant, i)}\n\n                </PlantsWrapper>\n              )\n            })\n          }\n\n          {userinfoMsg && (\n              <SuccessMsg>\n                <FormattedMessage\n                  id='userInfoSuccess'\n                  defaultMessage={userinfoMsg}\n                />\n              </SuccessMsg>\n          )}\n\n        </OrderDetails>\n      </PlantsPageContainer>\n\n      <PlantsPageContainer style={{ width: '100%' }}>\n        <BlockTitle>\n          <FormattedMessage\n            id=\"addController\"\n            defaultMessage=\"Your Plants\"\n          />\n        </BlockTitle>\n\n        <ListItem>\n          <ListTitle>\n            <Text bold>\n              <FormattedMessage\n                id='plantNameField'\n                defaultMessage='Name of the plant'\n              />\n            </Text>\n          </ListTitle>\n          <ListDes>\n            <Input\n              type='text'\n              name='name'\n              value={name}\n              onChange={(e) => setPlantName(e.target.value)}\n              backgroundColor='#F7F7F7'\n              width='197px'\n            />\n          </ListDes>\n        </ListItem>\n\n        <ListItem>\n          <ListTitle>\n            <Text bold>\n              <FormattedMessage\n                id='plantIdField'\n                defaultMessage='ID of the controller'\n              />\n            </Text>\n          </ListTitle>\n          <ListDes>\n            <Input\n              type='number'\n              name='plantId'\n              value={plantId}\n              onChange={(e) => setControllerID(e.target.value)}\n              backgroundColor='#F7F7F7'\n              width='197px'\n            />\n          </ListDes>\n        </ListItem>\n\n        <Button className=\"cart-button\" variant=\"secondary\" borderRadius={100} onClick={handleAddClick}>\n          <ButtonText>\n            <FormattedMessage id={\"addPlantButton\"} defaultMessage=\"Add plant\" />\n          </ButtonText>\n        </Button>\n      </PlantsPageContainer>\n    </PlantPageWrapper>\n  );\n};\n\nexport default YourPlants;\n"]},"metadata":{},"sourceType":"module"}