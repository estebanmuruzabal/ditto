{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/estebanmuruzabal/work/Mahdi-Fashion/client/packages/shop/src/features/checkouts/checkout-one/checkout-one.tsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useContext, useState, useEffect } from 'react';\nimport Router from 'next/router';\nimport { Button } from 'components/button/button';\nimport RadioCard from 'components/radio-card/radio-card';\nimport RadioGroup from 'components/radio-group/radio-group';\nimport UpdateAddress from 'components/address-card/address-card';\nimport UpdateContact from 'components/contact-card/contact-card';\nimport { DELETE_ADDRESS } from 'graphql/mutation/address';\nimport { DELETE_CARD } from 'graphql/mutation/card';\nimport { DELETE_CONTACT } from 'graphql/mutation/contact';\nimport { openModal } from '@redq/reuse-modal';\nimport { useMutation } from '@apollo/react-hooks';\nimport CheckoutWrapper, { CheckoutContainer, OrderSummary, OrderSummaryItem, OrderLabel, OrderAmount, DeliverySchedule, Heading, DeliveryAddress, ButtonGroup, Contact, PaymentOption, CheckoutSubmit, CouponBoxWrapper, ErrorMsg } from './checkout-one.style';\nimport CouponBox, { CouponDisplay } from 'components/coupon-box/coupon-box';\nimport { ProfileContext } from 'contexts/profile/profile.context';\nimport { FormattedMessage } from 'react-intl';\nimport { useCart } from 'contexts/cart/use-cart';\nimport { APPLY_COUPON } from 'graphql/mutation/coupon'; // The type of props Checkout Form receives\n\nvar Checkout = function Checkout(_ref) {\n  _s();\n\n  var token = _ref.token,\n      deviceType = _ref.deviceType;\n\n  var _useCart = useCart(),\n      removeCoupon = _useCart.removeCoupon,\n      coupon = _useCart.coupon,\n      applyCoupon = _useCart.applyCoupon,\n      clearCart = _useCart.clearCart,\n      cartItemsCount = _useCart.cartItemsCount,\n      calculatePrice = _useCart.calculatePrice,\n      calculateDiscount = _useCart.calculateDiscount,\n      calculateSubTotalPrice = _useCart.calculateSubTotalPrice,\n      isRestaurant = _useCart.isRestaurant,\n      toggleRestaurant = _useCart.toggleRestaurant;\n\n  var _useState = useState(''),\n      couponCode = _useState[0],\n      setCouponCode = _useState[1];\n\n  var _useState2 = useState(''),\n      couponError = _useState2[0],\n      setError = _useState2[1];\n\n  var _useContext = useContext(ProfileContext),\n      state = _useContext.state,\n      dispatch = _useContext.dispatch;\n\n  var _useState3 = useState(false),\n      loading = _useState3[0],\n      setLoading = _useState3[1];\n\n  var _useState4 = useState(false),\n      isValid = _useState4[0],\n      setIsValid = _useState4[1];\n\n  var address = state.address,\n      contact = state.contact,\n      card = state.card,\n      schedules = state.schedules;\n\n  var _useMutation = useMutation(DELETE_CONTACT),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      deleteContactMutation = _useMutation2[0];\n\n  var _useMutation3 = useMutation(DELETE_ADDRESS),\n      _useMutation4 = _slicedToArray(_useMutation3, 1),\n      deleteAddressMutation = _useMutation4[0];\n\n  var _useMutation5 = useMutation(DELETE_CARD),\n      _useMutation6 = _slicedToArray(_useMutation5, 1),\n      deletePaymentCardMutation = _useMutation6[0];\n\n  var _useMutation7 = useMutation(APPLY_COUPON),\n      _useMutation8 = _slicedToArray(_useMutation7, 1),\n      appliedCoupon = _useMutation8[0];\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n\n              if (isValid) {\n                clearCart();\n                Router.push('/order-received');\n              }\n\n              setLoading(false);\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleSubmit() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (calculatePrice() > 0 && cartItemsCount > 0 && address.length && contact.length && card.length && schedules.length) {\n      setIsValid(true);\n    }\n  }, [state]);\n  useEffect(function () {\n    return function () {\n      if (isRestaurant) {\n        toggleRestaurant();\n        clearCart();\n      }\n    };\n  }, []); // Add or edit modal\n\n  var handleModal = function handleModal(modalComponent) {\n    var modalProps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var className = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'add-address-modal';\n    openModal({\n      show: true,\n      config: {\n        width: 360,\n        height: 'auto',\n        enableResizing: false,\n        disableDragging: true,\n        className: className\n      },\n      closeOnClickOutside: true,\n      component: modalComponent,\n      componentProps: {\n        item: modalProps\n      }\n    });\n  };\n\n  var handleEditDelete = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(item, type, name) {\n      var modalComponent;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(type === 'edit')) {\n                _context2.next = 5;\n                break;\n              }\n\n              modalComponent = name === 'address' ? UpdateAddress : UpdateContact;\n              handleModal(modalComponent, item);\n              _context2.next = 21;\n              break;\n\n            case 5:\n              _context2.t0 = name;\n              _context2.next = _context2.t0 === 'payment' ? 8 : _context2.t0 === 'contact' ? 12 : _context2.t0 === 'address' ? 16 : 20;\n              break;\n\n            case 8:\n              dispatch({\n                type: 'DELETE_CARD',\n                payload: item.id\n              });\n              _context2.next = 11;\n              return deletePaymentCardMutation({\n                variables: {\n                  cardId: JSON.stringify(item.id)\n                }\n              });\n\n            case 11:\n              return _context2.abrupt(\"return\", _context2.sent);\n\n            case 12:\n              dispatch({\n                type: 'DELETE_CONTACT',\n                payload: item.id\n              });\n              _context2.next = 15;\n              return deleteContactMutation({\n                variables: {\n                  contactId: JSON.stringify(item.id)\n                }\n              });\n\n            case 15:\n              return _context2.abrupt(\"return\", _context2.sent);\n\n            case 16:\n              dispatch({\n                type: 'DELETE_ADDRESS',\n                payload: item.id\n              });\n              _context2.next = 19;\n              return deleteAddressMutation({\n                variables: {\n                  addressId: JSON.stringify(item.id)\n                }\n              });\n\n            case 19:\n              return _context2.abrupt(\"return\", _context2.sent);\n\n            case 20:\n              return _context2.abrupt(\"return\", false);\n\n            case 21:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleEditDelete(_x, _x2, _x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handleApplyCoupon = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var _yield$appliedCoupon, data;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return appliedCoupon({\n                variables: {\n                  code: couponCode\n                }\n              });\n\n            case 2:\n              _yield$appliedCoupon = _context3.sent;\n              data = _yield$appliedCoupon.data;\n\n              if (data.applyCoupon && data.applyCoupon.discountInPercent) {\n                applyCoupon(data.applyCoupon);\n                setCouponCode('');\n              } else {\n                setError('Invalid Coupon');\n              }\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleApplyCoupon() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var handleOnUpdate = function handleOnUpdate(e) {\n    setCouponCode(e.currentTarget.value);\n  };\n\n  return __jsx(\"form\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 5\n    }\n  }, __jsx(CheckoutWrapper, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 7\n    }\n  }, __jsx(CheckoutContainer, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 9\n    }\n  }, __jsx(OrderSummary, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 11\n    }\n  }, __jsx(OrderSummaryItem, {\n    style: {\n      marginBottom: 15\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 13\n    }\n  }, __jsx(OrderLabel, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 15\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"subTotal\",\n    defaultMessage: \"Subtotal\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 17\n    }\n  }), \" (\", cartItemsCount, ' ', __jsx(FormattedMessage, {\n    id: \"itemsText\",\n    defaultMessage: \"items\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 17\n    }\n  }), \")\"), __jsx(OrderAmount, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 15\n    }\n  }, \"$\", calculateSubTotalPrice())), __jsx(OrderSummaryItem, {\n    style: {\n      marginBottom: 30\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 13\n    }\n  }, __jsx(OrderLabel, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 15\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"shippingFeeText\",\n    defaultMessage: \"Shipping Fee\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 17\n    }\n  })), __jsx(OrderAmount, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 15\n    }\n  }, \"$0.00\")), __jsx(OrderSummaryItem, {\n    style: {\n      marginBottom: 30\n    },\n    className: \"voucherWrapper\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 13\n    }\n  }, __jsx(OrderLabel, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 15\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"voucherText\",\n    defaultMessage: \"Voucher\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 17\n    }\n  })), coupon ? __jsx(CouponDisplay, {\n    code: coupon.code,\n    sign: \"-\",\n    currency: \"$\",\n    price: calculateDiscount(),\n    onClick: function onClick(e) {\n      e.preventDefault();\n      removeCoupon();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 17\n    }\n  }) : __jsx(React.Fragment, null, __jsx(CouponBoxWrapper, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 19\n    }\n  }, __jsx(CouponBox, {\n    onClick: handleApplyCoupon,\n    value: couponCode,\n    onChange: handleOnUpdate,\n    style: {\n      maxWidth: 350,\n      height: 50\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 21\n    }\n  }), couponError && __jsx(ErrorMsg, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 23\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"couponError\",\n    defaultMessage: couponError,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 25\n    }\n  }))))), __jsx(OrderSummaryItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 13\n    }\n  }, __jsx(OrderLabel, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 15\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"totalText\",\n    defaultMessage: \"Total\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 17\n    }\n  })), __jsx(OrderAmount, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 15\n    }\n  }, \"$\", calculatePrice()))), __jsx(DeliverySchedule, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 11\n    }\n  }, __jsx(Heading, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 13\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"deliverySchedule\",\n    defaultMessage: \"Select Your Delivery Schedule\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 15\n    }\n  })), __jsx(RadioGroup, {\n    items: schedules,\n    component: function component(item) {\n      return __jsx(RadioCard, {\n        id: item.id,\n        key: item.id,\n        title: item.title,\n        content: item.time_slot,\n        name: \"schedule\",\n        checked: item.type === 'primary',\n        withActionButtons: false,\n        onChange: function onChange() {\n          return dispatch({\n            type: 'SET_PRIMARY_SCHEDULE',\n            payload: item.id.toString()\n          });\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 17\n        }\n      });\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 13\n    }\n  })), __jsx(DeliveryAddress, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 11\n    }\n  }, __jsx(Heading, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 13\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"checkoutDeliveryAddress\",\n    defaultMessage: \"Select Your Delivery Address\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 15\n    }\n  })), __jsx(ButtonGroup, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 13\n    }\n  }, __jsx(RadioGroup, {\n    items: address,\n    component: function component(item) {\n      return __jsx(RadioCard, {\n        id: item.id,\n        key: item.id,\n        title: item.name,\n        content: item.info,\n        name: \"address\",\n        checked: item.type === 'primary',\n        onChange: function onChange() {\n          return dispatch({\n            type: 'SET_PRIMARY_ADDRESS',\n            payload: item.id.toString()\n          });\n        },\n        onEdit: function onEdit() {\n          return handleEditDelete(item, 'edit', 'address');\n        },\n        onDelete: function onDelete() {\n          return handleEditDelete(item, 'delete', 'address');\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 19\n        }\n      });\n    },\n    secondaryComponent: // <Button\n    //   title=\"Add Address\"\n    //   iconPosition=\"right\"\n    //   colors=\"primary\"\n    //   size=\"small\"\n    //   variant=\"outlined\"\n    //   type=\"button\"\n    //   intlButtonId=\"addAddressBtn\"\n    //   onClick={() =>\n    //     handleModal(UpdateAddress, 'add-address-modal')\n    //   }\n    // />\n    __jsx(Button, {\n      size: \"big\",\n      variant: \"outlined\",\n      type: \"button\",\n      className: \"add-button\",\n      onClick: function onClick() {\n        return handleModal(UpdateAddress, 'add-address-modal');\n      },\n      style: {\n        borderStyle: 'dashed'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 19\n      }\n    }, __jsx(FormattedMessage, {\n      id: \"addAddressBtn\",\n      defaultMessage: \"Add Address\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 21\n      }\n    })),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 15\n    }\n  }))), __jsx(Contact, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 11\n    }\n  }, __jsx(Heading, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 13\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"contactNumberText\",\n    defaultMessage: \"Select Your Contact Number\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 15\n    }\n  })), __jsx(ButtonGroup, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 13\n    }\n  }, __jsx(RadioGroup, {\n    items: contact,\n    component: function component(item) {\n      return __jsx(RadioCard, {\n        id: item.id,\n        key: item.id,\n        title: item.type,\n        content: item.number,\n        checked: item.type === 'primary',\n        onChange: function onChange() {\n          return dispatch({\n            type: 'SET_PRIMARY_CONTACT',\n            payload: item.id.toString()\n          });\n        },\n        name: \"contact\",\n        onEdit: function onEdit() {\n          return handleEditDelete(item, 'edit', 'contact');\n        },\n        onDelete: function onDelete() {\n          return handleEditDelete(item, 'delete', 'contact');\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 19\n        }\n      });\n    },\n    secondaryComponent: // <Button\n    //   title='Add Contact'\n    //   iconPosition='right'\n    //   colors='primary'\n    //   size='small'\n    //   variant='outlined'\n    //   type='button'\n    //   intlButtonId='addContactBtn'\n    //   onClick={() =>\n    //     handleModal(UpdateContact, 'add-contact-modal')\n    //   }\n    // />\n    __jsx(Button, {\n      size: \"big\",\n      variant: \"outlined\",\n      type: \"button\",\n      className: \"add-button\",\n      onClick: function onClick() {\n        return handleModal(UpdateContact, 'add-contact-modal');\n      },\n      style: {\n        borderStyle: 'dashed'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 19\n      }\n    }, __jsx(FormattedMessage, {\n      id: \"addContactBtn\",\n      defaultMessage: \"Add Contact\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 21\n      }\n    })),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 15\n    }\n  }))), __jsx(PaymentOption, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 11\n    }\n  }, __jsx(Heading, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 13\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"selectPaymentText\",\n    defaultMessage: \"Select Payment Option\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 15\n    }\n  }))), __jsx(CheckoutSubmit, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    type: \"button\",\n    onClick: handleSubmit,\n    disabled: !isValid,\n    size: \"big\",\n    loading: loading,\n    width: \"100%\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 13\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"processCheckout\",\n    defaultMessage: \"Proceed to Checkout\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 438,\n      columnNumber: 15\n    }\n  }))))));\n};\n\n_s(Checkout, \"kAI/NXtOTCfaFtlzAGvhc09dfwo=\", false, function () {\n  return [useCart, useMutation, useMutation, useMutation, useMutation];\n});\n\n_c = Checkout;\nexport default Checkout;\n\nvar _c;\n\n$RefreshReg$(_c, \"Checkout\");","map":{"version":3,"sources":["/Users/estebanmuruzabal/work/Mahdi-Fashion/client/packages/shop/src/features/checkouts/checkout-one/checkout-one.tsx"],"names":["React","useContext","useState","useEffect","Router","Button","RadioCard","RadioGroup","UpdateAddress","UpdateContact","DELETE_ADDRESS","DELETE_CARD","DELETE_CONTACT","openModal","useMutation","CheckoutWrapper","CheckoutContainer","OrderSummary","OrderSummaryItem","OrderLabel","OrderAmount","DeliverySchedule","Heading","DeliveryAddress","ButtonGroup","Contact","PaymentOption","CheckoutSubmit","CouponBoxWrapper","ErrorMsg","CouponBox","CouponDisplay","ProfileContext","FormattedMessage","useCart","APPLY_COUPON","Checkout","token","deviceType","removeCoupon","coupon","applyCoupon","clearCart","cartItemsCount","calculatePrice","calculateDiscount","calculateSubTotalPrice","isRestaurant","toggleRestaurant","couponCode","setCouponCode","couponError","setError","state","dispatch","loading","setLoading","isValid","setIsValid","address","contact","card","schedules","deleteContactMutation","deleteAddressMutation","deletePaymentCardMutation","appliedCoupon","handleSubmit","push","length","handleModal","modalComponent","modalProps","className","show","config","width","height","enableResizing","disableDragging","closeOnClickOutside","component","componentProps","item","handleEditDelete","type","name","payload","id","variables","cardId","JSON","stringify","contactId","addressId","handleApplyCoupon","code","data","discountInPercent","handleOnUpdate","e","currentTarget","value","marginBottom","preventDefault","maxWidth","title","time_slot","toString","info","borderStyle","number"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect } from 'react';\nimport Router from 'next/router';\nimport { Button } from 'components/button/button';\nimport RadioCard from 'components/radio-card/radio-card';\nimport RadioGroup from 'components/radio-group/radio-group';\nimport UpdateAddress from 'components/address-card/address-card';\nimport UpdateContact from 'components/contact-card/contact-card';\nimport StripePaymentForm from 'features/payment/stripe-form';\nimport { DELETE_ADDRESS } from 'graphql/mutation/address';\nimport { DELETE_CARD } from 'graphql/mutation/card';\nimport { DELETE_CONTACT } from 'graphql/mutation/contact';\nimport { openModal } from '@redq/reuse-modal';\nimport { useMutation } from '@apollo/react-hooks';\nimport CheckoutWrapper, {\n  CheckoutContainer,\n  OrderSummary,\n  OrderSummaryItem,\n  OrderLabel,\n  OrderAmount,\n  DeliverySchedule,\n  Heading,\n  DeliveryAddress,\n  ButtonGroup,\n  Contact,\n  PaymentOption,\n  CheckoutSubmit,\n  CouponBoxWrapper,\n  ErrorMsg,\n} from './checkout-one.style';\n\nimport CouponBox, { CouponDisplay } from 'components/coupon-box/coupon-box';\nimport { ProfileContext } from 'contexts/profile/profile.context';\nimport { FormattedMessage } from 'react-intl';\nimport { useCart } from 'contexts/cart/use-cart';\nimport { APPLY_COUPON } from 'graphql/mutation/coupon';\n\n// The type of props Checkout Form receives\ninterface MyFormProps {\n  token: string;\n  deviceType: any;\n}\n\nconst Checkout: React.FC<MyFormProps> = ({ token, deviceType }) => {\n  const {\n    removeCoupon,\n    coupon,\n    applyCoupon,\n    clearCart,\n    cartItemsCount,\n    calculatePrice,\n    calculateDiscount,\n    calculateSubTotalPrice,\n    isRestaurant,\n    toggleRestaurant,\n  } = useCart();\n  const [couponCode, setCouponCode] = useState('');\n  const [couponError, setError] = useState('');\n  const { state, dispatch } = useContext(ProfileContext);\n  const [loading, setLoading] = useState(false);\n  const [isValid, setIsValid] = useState(false);\n  const { address, contact, card, schedules } = state;\n\n  const [deleteContactMutation] = useMutation(DELETE_CONTACT);\n  const [deleteAddressMutation] = useMutation(DELETE_ADDRESS);\n  const [deletePaymentCardMutation] = useMutation(DELETE_CARD);\n  const [appliedCoupon] = useMutation(APPLY_COUPON);\n\n  const handleSubmit = async () => {\n    setLoading(true);\n    if (isValid) {\n      clearCart();\n      Router.push('/order-received');\n    }\n    setLoading(false);\n  };\n\n  useEffect(() => {\n    if (\n      calculatePrice() > 0 &&\n      cartItemsCount > 0 &&\n      address.length &&\n      contact.length &&\n      card.length &&\n      schedules.length\n    ) {\n      setIsValid(true);\n    }\n  }, [state]);\n  useEffect(() => {\n    return () => {\n      if (isRestaurant) {\n        toggleRestaurant();\n        clearCart();\n      }\n    };\n  }, []);\n  // Add or edit modal\n  const handleModal = (\n    modalComponent: any,\n    modalProps = {},\n    className: string = 'add-address-modal'\n  ) => {\n    openModal({\n      show: true,\n      config: {\n        width: 360,\n        height: 'auto',\n        enableResizing: false,\n        disableDragging: true,\n        className: className,\n      },\n      closeOnClickOutside: true,\n      component: modalComponent,\n      componentProps: { item: modalProps },\n    });\n  };\n\n  const handleEditDelete = async (item: any, type: string, name: string) => {\n    if (type === 'edit') {\n      const modalComponent = name === 'address' ? UpdateAddress : UpdateContact;\n      handleModal(modalComponent, item);\n    } else {\n      switch (name) {\n        case 'payment':\n          dispatch({ type: 'DELETE_CARD', payload: item.id });\n\n          return await deletePaymentCardMutation({\n            variables: { cardId: JSON.stringify(item.id) },\n          });\n        case 'contact':\n          dispatch({ type: 'DELETE_CONTACT', payload: item.id });\n\n          return await deleteContactMutation({\n            variables: { contactId: JSON.stringify(item.id) },\n          });\n        case 'address':\n          dispatch({ type: 'DELETE_ADDRESS', payload: item.id });\n\n          return await deleteAddressMutation({\n            variables: { addressId: JSON.stringify(item.id) },\n          });\n        default:\n          return false;\n      }\n    }\n  };\n\n  const handleApplyCoupon = async () => {\n    const { data }: any = await appliedCoupon({\n      variables: { code: couponCode },\n    });\n    if (data.applyCoupon && data.applyCoupon.discountInPercent) {\n      applyCoupon(data.applyCoupon);\n      setCouponCode('');\n    } else {\n      setError('Invalid Coupon');\n    }\n  };\n  const handleOnUpdate: React.ChangeEventHandler<HTMLInputElement> = (e) => {\n    setCouponCode(e.currentTarget.value);\n  };\n\n  return (\n    <form>\n      <CheckoutWrapper>\n        <CheckoutContainer>\n          <OrderSummary>\n            <OrderSummaryItem style={{ marginBottom: 15 }}>\n              <OrderLabel>\n                <FormattedMessage id=\"subTotal\" defaultMessage=\"Subtotal\" /> (\n                {cartItemsCount}{' '}\n                <FormattedMessage id=\"itemsText\" defaultMessage=\"items\" />)\n              </OrderLabel>\n              <OrderAmount>${calculateSubTotalPrice()}</OrderAmount>\n            </OrderSummaryItem>\n\n            <OrderSummaryItem style={{ marginBottom: 30 }}>\n              <OrderLabel>\n                <FormattedMessage\n                  id=\"shippingFeeText\"\n                  defaultMessage=\"Shipping Fee\"\n                />\n              </OrderLabel>\n              <OrderAmount>$0.00</OrderAmount>\n            </OrderSummaryItem>\n\n            <OrderSummaryItem\n              style={{ marginBottom: 30 }}\n              className=\"voucherWrapper\"\n            >\n              <OrderLabel>\n                <FormattedMessage id=\"voucherText\" defaultMessage=\"Voucher\" />\n              </OrderLabel>\n              {coupon ? (\n                <CouponDisplay\n                  code={coupon.code}\n                  sign=\"-\"\n                  currency=\"$\"\n                  price={calculateDiscount()}\n                  onClick={(e) => {\n                    e.preventDefault();\n                    removeCoupon();\n                  }}\n                />\n              ) : (\n                <>\n                  <CouponBoxWrapper>\n                    <CouponBox\n                      onClick={handleApplyCoupon}\n                      value={couponCode}\n                      onChange={handleOnUpdate}\n                      style={{ maxWidth: 350, height: 50 }}\n                    />\n                    {couponError && (\n                      <ErrorMsg>\n                        <FormattedMessage\n                          id=\"couponError\"\n                          defaultMessage={couponError}\n                        />\n                      </ErrorMsg>\n                    )}\n                  </CouponBoxWrapper>\n                </>\n              )}\n            </OrderSummaryItem>\n\n            <OrderSummaryItem>\n              <OrderLabel>\n                <FormattedMessage id=\"totalText\" defaultMessage=\"Total\" />\n              </OrderLabel>\n              <OrderAmount>${calculatePrice()}</OrderAmount>\n            </OrderSummaryItem>\n          </OrderSummary>\n          {/* DeliverySchedule */}\n          <DeliverySchedule>\n            <Heading>\n              <FormattedMessage\n                id=\"deliverySchedule\"\n                defaultMessage=\"Select Your Delivery Schedule\"\n              />\n            </Heading>\n            <RadioGroup\n              items={schedules}\n              component={(item: any) => (\n                <RadioCard\n                  id={item.id}\n                  key={item.id}\n                  title={item.title}\n                  content={item.time_slot}\n                  name=\"schedule\"\n                  checked={item.type === 'primary'}\n                  withActionButtons={false}\n                  onChange={() =>\n                    dispatch({\n                      type: 'SET_PRIMARY_SCHEDULE',\n                      payload: item.id.toString(),\n                    })\n                  }\n                />\n              )}\n            />\n          </DeliverySchedule>\n          {/* DeliveryAddress */}\n          <DeliveryAddress>\n            <Heading>\n              <FormattedMessage\n                id=\"checkoutDeliveryAddress\"\n                defaultMessage=\"Select Your Delivery Address\"\n              />\n            </Heading>\n            <ButtonGroup>\n              <RadioGroup\n                items={address}\n                component={(item: any) => (\n                  <RadioCard\n                    id={item.id}\n                    key={item.id}\n                    title={item.name}\n                    content={item.info}\n                    name=\"address\"\n                    checked={item.type === 'primary'}\n                    onChange={() =>\n                      dispatch({\n                        type: 'SET_PRIMARY_ADDRESS',\n                        payload: item.id.toString(),\n                      })\n                    }\n                    onEdit={() => handleEditDelete(item, 'edit', 'address')}\n                    onDelete={() => handleEditDelete(item, 'delete', 'address')}\n                  />\n                )}\n                secondaryComponent={\n                  // <Button\n                  //   title=\"Add Address\"\n                  //   iconPosition=\"right\"\n                  //   colors=\"primary\"\n                  //   size=\"small\"\n                  //   variant=\"outlined\"\n                  //   type=\"button\"\n                  //   intlButtonId=\"addAddressBtn\"\n                  //   onClick={() =>\n                  //     handleModal(UpdateAddress, 'add-address-modal')\n                  //   }\n                  // />\n\n                  <Button\n                    size=\"big\"\n                    variant=\"outlined\"\n                    type=\"button\"\n                    className=\"add-button\"\n                    onClick={() =>\n                      handleModal(UpdateAddress, 'add-address-modal')\n                    }\n                    style={{ borderStyle: 'dashed' }}\n                  >\n                    <FormattedMessage\n                      id=\"addAddressBtn\"\n                      defaultMessage=\"Add Address\"\n                    />\n                  </Button>\n                }\n              />\n            </ButtonGroup>\n          </DeliveryAddress>\n          {/* Contact number */}\n          <Contact>\n            <Heading>\n              <FormattedMessage\n                id=\"contactNumberText\"\n                defaultMessage=\"Select Your Contact Number\"\n              />\n            </Heading>\n            <ButtonGroup>\n              <RadioGroup\n                items={contact}\n                component={(item: any) => (\n                  <RadioCard\n                    id={item.id}\n                    key={item.id}\n                    title={item.type}\n                    content={item.number}\n                    checked={item.type === 'primary'}\n                    onChange={() =>\n                      dispatch({\n                        type: 'SET_PRIMARY_CONTACT',\n                        payload: item.id.toString(),\n                      })\n                    }\n                    name=\"contact\"\n                    onEdit={() => handleEditDelete(item, 'edit', 'contact')}\n                    onDelete={() => handleEditDelete(item, 'delete', 'contact')}\n                  />\n                )}\n                secondaryComponent={\n                  // <Button\n                  //   title='Add Contact'\n                  //   iconPosition='right'\n                  //   colors='primary'\n                  //   size='small'\n                  //   variant='outlined'\n                  //   type='button'\n                  //   intlButtonId='addContactBtn'\n                  //   onClick={() =>\n                  //     handleModal(UpdateContact, 'add-contact-modal')\n                  //   }\n                  // />\n\n                  <Button\n                    size=\"big\"\n                    variant=\"outlined\"\n                    type=\"button\"\n                    className=\"add-button\"\n                    onClick={() =>\n                      handleModal(UpdateContact, 'add-contact-modal')\n                    }\n                    style={{ borderStyle: 'dashed' }}\n                  >\n                    <FormattedMessage\n                      id=\"addContactBtn\"\n                      defaultMessage=\"Add Contact\"\n                    />\n                  </Button>\n                }\n              />\n            </ButtonGroup>\n          </Contact>\n          {/* PaymentOption */}\n          <PaymentOption>\n            <Heading>\n              <FormattedMessage\n                id=\"selectPaymentText\"\n                defaultMessage=\"Select Payment Option\"\n              />\n            </Heading>\n            {/*<PaymentGroup\n              name=\"payment\"\n              deviceType={deviceType}\n              items={card}\n              onEditDeleteField={(item: any, type: string) =>\n                handleEditDelete(item, type, 'payment')\n              }\n              onChange={(item: any) =>\n                dispatch({\n                  type: 'SET_PRIMARY_CARD',\n                  payload: item.id.toString(),\n                })\n              }\n              handleAddNewCard={() => {\n                handleModal(\n                  StripePaymentForm,\n                  { totalPrice: calculatePrice() },\n                  'add-address-modal stripe-modal'\n                );\n              }}\n            />*/}\n          </PaymentOption>\n          {/* CheckoutSubmit */}\n          <CheckoutSubmit>\n            {/* <Button\n              onClick={handleSubmit}\n              type='button'\n              disabled={!isValid}\n              title='Proceed to Checkout'\n              // size='small'\n              intlButtonId='proceesCheckout'\n              loader={<Loader />}\n              isLoading={loading}\n            /> */}\n\n            <Button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={!isValid}\n              size=\"big\"\n              loading={loading}\n              width=\"100%\"\n            >\n              <FormattedMessage\n                id=\"processCheckout\"\n                defaultMessage=\"Proceed to Checkout\"\n              />\n            </Button>\n          </CheckoutSubmit>\n        </CheckoutContainer>\n      </CheckoutWrapper>\n    </form>\n  );\n};\n\nexport default Checkout;\n"]},"metadata":{},"sourceType":"module"}