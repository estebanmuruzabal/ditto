{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _s = $RefreshSig$(),\n    _this = this,\n    _jsxFileName = \"/Users/estebanmuruzabal/work/ditto/client/packages/shop/src/contexts/cart/use-cart.tsx\",\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useReducer, useContext, createContext } from 'react';\nimport { reducer, cartItemsTotalPrice, cartDiscountAmount } from './cart.reducer';\nimport { useStorage } from 'utils/use-storage';\nvar CartContext = createContext({});\nvar INITIAL_STATE = {\n  isOpen: false,\n  items: [],\n  isRestaurant: false,\n  coupon: null\n};\n\nvar useCartActions = function useCartActions() {\n  _s();\n\n  var _state$items3;\n\n  var initialCart = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : INITIAL_STATE;\n\n  var _useReducer = useReducer(reducer, initialCart),\n      state = _useReducer[0],\n      dispatch = _useReducer[1];\n\n  var addItemHandler = function addItemHandler(item) {\n    var quantity = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    dispatch({\n      type: 'ADD_ITEM',\n      payload: _objectSpread(_objectSpread({}, item), {}, {\n        quantity: quantity\n      })\n    });\n  };\n\n  var addRecicledItemHandler = function addRecicledItemHandler(item) {\n    var recicledQuantity = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    dispatch({\n      type: 'ADD_ITEM_RECICLED',\n      payload: _objectSpread(_objectSpread({}, item), {}, {\n        recicledQuantity: recicledQuantity\n      })\n    });\n  };\n\n  var removeRecicledItemHandler = function removeRecicledItemHandler(item) {\n    var recicledQuantity = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    dispatch({\n      type: 'REMOVE_ITEM_RECICLED',\n      payload: _objectSpread(_objectSpread({}, item), {}, {\n        recicledQuantity: recicledQuantity\n      })\n    });\n  };\n\n  var removeItemHandler = function removeItemHandler(item) {\n    var quantity = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    dispatch({\n      type: 'REMOVE_ITEM',\n      payload: _objectSpread(_objectSpread({}, item), {}, {\n        quantity: quantity\n      })\n    });\n  };\n\n  var clearItemFromCartHandler = function clearItemFromCartHandler(item) {\n    dispatch({\n      type: 'CLEAR_ITEM_FROM_CART',\n      payload: item\n    });\n  };\n\n  var clearCartHandler = function clearCartHandler() {\n    dispatch({\n      type: 'CLEAR_CART'\n    });\n  };\n\n  var toggleCartHandler = function toggleCartHandler() {\n    dispatch({\n      type: 'TOGGLE_CART'\n    });\n  };\n\n  var couponHandler = function couponHandler(coupon) {\n    dispatch({\n      type: 'APPLY_COUPON',\n      payload: coupon\n    });\n  };\n\n  var removeCouponHandler = function removeCouponHandler() {\n    dispatch({\n      type: 'REMOVE_COUPON'\n    });\n  };\n\n  var rehydrateLocalState = function rehydrateLocalState(payload) {\n    dispatch({\n      type: 'REHYDRATE',\n      payload: payload\n    });\n  };\n\n  var toggleRestaurant = function toggleRestaurant() {\n    dispatch({\n      type: 'TOGGLE_RESTAURANT'\n    });\n  };\n\n  var isInCartHandler = function isInCartHandler(id) {\n    var _state$items;\n\n    return (_state$items = state.items) === null || _state$items === void 0 ? void 0 : _state$items.some(function (item) {\n      return item.id === id;\n    });\n  };\n\n  var getItemHandler = function getItemHandler(id) {\n    var _state$items2;\n\n    return (_state$items2 = state.items) === null || _state$items2 === void 0 ? void 0 : _state$items2.find(function (item) {\n      return item.id === id;\n    });\n  };\n\n  var getCartItemsPrice = function getCartItemsPrice() {\n    return cartItemsTotalPrice(state.items).toFixed(2);\n  };\n\n  var getCartItemsTotalPrice = function getCartItemsTotalPrice(deliveryCharge) {\n    return cartItemsTotalPrice(state.items, state.coupon, deliveryCharge).toFixed(2);\n  };\n\n  var getDiscount = function getDiscount() {\n    return cartDiscountAmount(state.items, state.coupon).toFixed(2);\n  };\n\n  var getItemsCount = ((_state$items3 = state.items) === null || _state$items3 === void 0 ? void 0 : _state$items3.reduce(function (acc, item) {\n    return acc + (item.quantity || 0);\n  }, 0)) || 0;\n  return {\n    state: state,\n    getItemsCount: getItemsCount,\n    rehydrateLocalState: rehydrateLocalState,\n    addItemHandler: addItemHandler,\n    addRecicledItemHandler: addRecicledItemHandler,\n    removeRecicledItemHandler: removeRecicledItemHandler,\n    removeItemHandler: removeItemHandler,\n    clearItemFromCartHandler: clearItemFromCartHandler,\n    clearCartHandler: clearCartHandler,\n    isInCartHandler: isInCartHandler,\n    getItemHandler: getItemHandler,\n    toggleCartHandler: toggleCartHandler,\n    getCartItemsTotalPrice: getCartItemsTotalPrice,\n    getCartItemsPrice: getCartItemsPrice,\n    couponHandler: couponHandler,\n    removeCouponHandler: removeCouponHandler,\n    getDiscount: getDiscount,\n    toggleRestaurant: toggleRestaurant\n  };\n};\n\n_s(useCartActions, \"eanL7CPucd3H18vMQ/enxq1/NMY=\");\n\nexport var CartProvider = function CartProvider(_ref) {\n  _s2();\n\n  var _state$items4;\n\n  var children = _ref.children;\n\n  var _useCartActions = useCartActions(),\n      state = _useCartActions.state,\n      rehydrateLocalState = _useCartActions.rehydrateLocalState,\n      getItemsCount = _useCartActions.getItemsCount,\n      addItemHandler = _useCartActions.addItemHandler,\n      addRecicledItemHandler = _useCartActions.addRecicledItemHandler,\n      removeRecicledItemHandler = _useCartActions.removeRecicledItemHandler,\n      removeItemHandler = _useCartActions.removeItemHandler,\n      clearItemFromCartHandler = _useCartActions.clearItemFromCartHandler,\n      clearCartHandler = _useCartActions.clearCartHandler,\n      isInCartHandler = _useCartActions.isInCartHandler,\n      getItemHandler = _useCartActions.getItemHandler,\n      toggleCartHandler = _useCartActions.toggleCartHandler,\n      getCartItemsTotalPrice = _useCartActions.getCartItemsTotalPrice,\n      couponHandler = _useCartActions.couponHandler,\n      removeCouponHandler = _useCartActions.removeCouponHandler,\n      getCartItemsPrice = _useCartActions.getCartItemsPrice,\n      getDiscount = _useCartActions.getDiscount,\n      toggleRestaurant = _useCartActions.toggleRestaurant;\n\n  var _useStorage = useStorage(state, rehydrateLocalState),\n      rehydrated = _useStorage.rehydrated,\n      error = _useStorage.error;\n\n  return __jsx(CartContext.Provider, {\n    value: {\n      isOpen: state.isOpen,\n      items: state.items,\n      coupon: state.coupon,\n      isRestaurant: state.isRestaurant,\n      cartItemsCount: (_state$items4 = state.items) === null || _state$items4 === void 0 ? void 0 : _state$items4.length,\n      itemsCount: getItemsCount,\n      addItem: addItemHandler,\n      addRecicledItemHandler: addRecicledItemHandler,\n      removeRecicledItemHandler: removeRecicledItemHandler,\n      removeItem: removeItemHandler,\n      removeItemFromCart: clearItemFromCartHandler,\n      clearCart: clearCartHandler,\n      isInCart: isInCartHandler,\n      getItem: getItemHandler,\n      toggleCart: toggleCartHandler,\n      calculatePrice: getCartItemsTotalPrice,\n      calculateSubTotalPrice: getCartItemsPrice,\n      applyCoupon: couponHandler,\n      removeCoupon: removeCouponHandler,\n      calculateDiscount: getDiscount,\n      toggleRestaurant: toggleRestaurant\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 5\n    }\n  }, children);\n};\n\n_s2(CartProvider, \"+QyFb2q3B4Lrx7uq/IR8LUQT/ZI=\", false, function () {\n  return [useCartActions, useStorage];\n});\n\n_c = CartProvider;\nexport var useCart = function useCart() {\n  _s3();\n\n  return useContext(CartContext);\n};\n\n_s3(useCart, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"sources":["/Users/estebanmuruzabal/work/ditto/client/packages/shop/src/contexts/cart/use-cart.tsx"],"names":["React","useReducer","useContext","createContext","reducer","cartItemsTotalPrice","cartDiscountAmount","useStorage","CartContext","INITIAL_STATE","isOpen","items","isRestaurant","coupon","useCartActions","initialCart","state","dispatch","addItemHandler","item","quantity","type","payload","addRecicledItemHandler","recicledQuantity","removeRecicledItemHandler","removeItemHandler","clearItemFromCartHandler","clearCartHandler","toggleCartHandler","couponHandler","removeCouponHandler","rehydrateLocalState","toggleRestaurant","isInCartHandler","id","some","getItemHandler","find","getCartItemsPrice","toFixed","getCartItemsTotalPrice","deliveryCharge","getDiscount","getItemsCount","reduce","acc","CartProvider","children","rehydrated","error","cartItemsCount","length","itemsCount","addItem","removeItem","removeItemFromCart","clearCart","isInCart","getItem","toggleCart","calculatePrice","calculateSubTotalPrice","applyCoupon","removeCoupon","calculateDiscount","useCart"],"mappings":"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","sourcesContent":["import React, { useReducer, useContext, createContext } from 'react';\nimport { reducer, cartItemsTotalPrice, cartDiscountAmount } from './cart.reducer';\nimport { useStorage } from 'utils/use-storage';\n\nconst CartContext = createContext({} as any);\n\nconst INITIAL_STATE = {\n  isOpen: false,\n  items: [],\n  isRestaurant: false,\n  coupon: null,\n};\n\nconst useCartActions = (initialCart = INITIAL_STATE) => {\n  const [state, dispatch] = useReducer(reducer, initialCart);\n\n  const addItemHandler = (item, quantity = 1) => {\n    dispatch({ type: 'ADD_ITEM', payload: { ...item, quantity } });\n  };\n\n  const addRecicledItemHandler = (item, recicledQuantity = 1) => {\n    dispatch({ type: 'ADD_ITEM_RECICLED', payload: { ...item, recicledQuantity } });\n  };\n\n  const removeRecicledItemHandler = (item, recicledQuantity = 1) => {\n    dispatch({ type: 'REMOVE_ITEM_RECICLED', payload: { ...item, recicledQuantity } });\n  };\n\n  const removeItemHandler = (item, quantity = 1) => {\n    dispatch({ type: 'REMOVE_ITEM', payload: { ...item, quantity } });\n  };\n\n  const clearItemFromCartHandler = (item) => {\n    dispatch({ type: 'CLEAR_ITEM_FROM_CART', payload: item });\n  };\n\n  const clearCartHandler = () => {\n    dispatch({ type: 'CLEAR_CART' });\n  };\n\n  const toggleCartHandler = () => {\n    dispatch({ type: 'TOGGLE_CART' });\n  };\n\n  const couponHandler = (coupon) => {\n    dispatch({ type: 'APPLY_COUPON', payload: coupon });\n  };\n\n  const removeCouponHandler = () => {\n    dispatch({ type: 'REMOVE_COUPON' });\n  };\n\n  const rehydrateLocalState = (payload) => {\n    dispatch({ type: 'REHYDRATE', payload });\n  };\n\n  const toggleRestaurant = () => {\n    dispatch({ type: 'TOGGLE_RESTAURANT' });\n  };\n\n  const isInCartHandler = (id) => {\n    return state.items?.some((item) => item.id === id);\n  };\n\n  const getItemHandler = (id) => {\n    return state.items?.find((item) => item.id === id);\n  };\n\n  const getCartItemsPrice = () => cartItemsTotalPrice(state.items).toFixed(2);\n\n  const getCartItemsTotalPrice = (deliveryCharge) =>\n    cartItemsTotalPrice(state.items, state.coupon, deliveryCharge).toFixed(2);\n\n  const getDiscount = () => cartDiscountAmount(state.items, state.coupon).toFixed(2);\n\n  const getItemsCount = state.items?.reduce(\n    (acc, item) => acc + (item.quantity || 0),\n    0\n  ) || 0;\n\n  return {\n    state,\n    getItemsCount,\n    rehydrateLocalState,\n    addItemHandler,\n    addRecicledItemHandler,\n    removeRecicledItemHandler,\n    removeItemHandler,\n    clearItemFromCartHandler,\n    clearCartHandler,\n    isInCartHandler,\n    getItemHandler,\n    toggleCartHandler,\n    getCartItemsTotalPrice,\n    getCartItemsPrice,\n    couponHandler,\n    removeCouponHandler,\n    getDiscount,\n    toggleRestaurant,\n  };\n};\n\nexport const CartProvider = ({ children }) => {\n  const {\n    state,\n    rehydrateLocalState,\n    getItemsCount,\n    addItemHandler,\n    addRecicledItemHandler,\n    removeRecicledItemHandler,\n    removeItemHandler,\n    clearItemFromCartHandler,\n    clearCartHandler,\n    isInCartHandler,\n    getItemHandler,\n    toggleCartHandler,\n    getCartItemsTotalPrice,\n    couponHandler,\n    removeCouponHandler,\n    getCartItemsPrice,\n    getDiscount,\n    toggleRestaurant,\n  } = useCartActions();\n\n  const { rehydrated, error } = useStorage(state, rehydrateLocalState);\n\n  return (\n    <CartContext.Provider\n      value={{\n        isOpen: state.isOpen,\n        items: state.items,\n        coupon: state.coupon,\n        isRestaurant: state.isRestaurant,\n        cartItemsCount: state.items?.length,\n        itemsCount: getItemsCount,\n        addItem: addItemHandler,\n        addRecicledItemHandler,\n        removeRecicledItemHandler,\n        removeItem: removeItemHandler,\n        removeItemFromCart: clearItemFromCartHandler,\n        clearCart: clearCartHandler,\n        isInCart: isInCartHandler,\n        getItem: getItemHandler,\n        toggleCart: toggleCartHandler,\n        calculatePrice: getCartItemsTotalPrice,\n        calculateSubTotalPrice: getCartItemsPrice,\n        applyCoupon: couponHandler,\n        removeCoupon: removeCouponHandler,\n        calculateDiscount: getDiscount,\n        toggleRestaurant,\n      }}\n    >\n      {children}\n    </CartContext.Provider>\n  );\n};\n\nexport const useCart = () => useContext(CartContext);\n"]},"metadata":{},"sourceType":"module"}