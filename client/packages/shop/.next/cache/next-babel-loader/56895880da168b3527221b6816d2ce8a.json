{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/virginiamuruzabal/work/ditto/client/packages/shop/src/components/product-grid/product-list-two/product-list-two.tsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState } from 'react';\nimport { useRouter } from 'next/router';\nimport FoodCard from 'components/product-card/product-card-four/product-card-four';\nimport { ProductsRow, ProductsCol, ButtonWrapper, LoaderWrapper, LoaderItem, ProductCardWrapper } from '../product-list/product-list.style';\nimport { useQuery } from '@apollo/react-hooks';\nimport { Button } from 'components/button/button';\nimport Placeholder from 'components/placeholder/placeholder';\nimport Fade from 'react-reveal/Fade';\nimport NoResultFound from 'components/no-result/no-result';\nimport { customerDistance } from 'utils/customerDistance';\nimport { formatTime } from 'utils/formatTime';\nimport { FormattedMessage } from 'react-intl';\nimport { GET_VENDORS } from 'graphql/query/vendors.query';\nexport var Products = function Products(_ref) {\n  _s();\n\n  var _data$vendors;\n\n  var deviceType = _ref.deviceType,\n      type = _ref.type,\n      _ref$fetchLimit = _ref.fetchLimit,\n      fetchLimit = _ref$fetchLimit === void 0 ? 26 : _ref$fetchLimit,\n      _ref$loadMore = _ref.loadMore,\n      loadMore = _ref$loadMore === void 0 ? true : _ref$loadMore;\n  var router = useRouter();\n\n  var _useState = useState(false),\n      loadingMore = _useState[0],\n      toggleLoading = _useState[1];\n\n  var _useQuery = useQuery(GET_VENDORS, {\n    variables: {\n      type: type,\n      text: router.query.text,\n      category: router.query.category,\n      offset: 0,\n      limit: fetchLimit\n    }\n  }),\n      data = _useQuery.data,\n      error = _useQuery.error,\n      loading = _useQuery.loading,\n      fetchMore = _useQuery.fetchMore;\n\n  if (loading) {\n    return __jsx(LoaderWrapper, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 7\n      }\n    }, __jsx(LoaderItem, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }\n    }, __jsx(Placeholder, {\n      uniqueKey: \"1\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 11\n      }\n    })), __jsx(LoaderItem, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }\n    }, __jsx(Placeholder, {\n      uniqueKey: \"2\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 11\n      }\n    })), __jsx(LoaderItem, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }\n    }, __jsx(Placeholder, {\n      uniqueKey: \"3\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 11\n      }\n    })));\n  }\n\n  if (error) return __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 21\n    }\n  }, error.message);\n\n  if (!data || !data.vendors || data.vendors.items.length === 0) {\n    return __jsx(NoResultFound, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 12\n      }\n    });\n  }\n\n  var handleLoadMore = function handleLoadMore() {\n    toggleLoading(true);\n    fetchMore({\n      variables: {\n        offset: Number(data.vendors.items.length),\n        limit: fetchLimit\n      },\n      updateQuery: function updateQuery(prev, _ref2) {\n        var fetchMoreResult = _ref2.fetchMoreResult;\n        toggleLoading(false);\n\n        if (!fetchMoreResult) {\n          return prev;\n        }\n\n        return {\n          vendors: {\n            __typename: prev.vendors.__typename,\n            items: [].concat(_toConsumableArray(prev.vendors.items), _toConsumableArray(fetchMoreResult.vendors.items)),\n            totalCount: fetchMoreResult.vendors.totalCount,\n            hasMore: fetchMoreResult.vendors.hasMore\n          }\n        };\n      }\n    });\n  };\n\n  return __jsx(React.Fragment, null, __jsx(ProductsRow, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }\n  }, data === null || data === void 0 ? void 0 : (_data$vendors = data.vendors) === null || _data$vendors === void 0 ? void 0 : _data$vendors.items.map(function (item, index) {\n    return __jsx(ProductsCol, {\n      key: index,\n      className: \"food-col\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 11\n      }\n    }, __jsx(ProductCardWrapper, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }\n    }, __jsx(Fade, {\n      duration: 800,\n      delay: index * 10,\n      style: {\n        height: '100%'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 15\n      }\n    }, __jsx(FoodCard, {\n      name: item.name,\n      image: item.thumbnailUrl,\n      restaurantType: item === null || item === void 0 ? void 0 : item.categories.join(', '),\n      duration: formatTime(customerDistance()),\n      delivery: item.deliveryDetails.charge,\n      isFree: item.deliveryDetails.isFree,\n      discountInPercent: item.promotion,\n      data: item,\n      onClick: function onClick() {\n        return router.push('/restaurant/[slug]', \"/restaurant/\".concat(item.slug));\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }\n    }))));\n  })), loadMore && data.vendors.hasMore && __jsx(ButtonWrapper, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 9\n    }\n  }, __jsx(Button, {\n    onClick: handleLoadMore,\n    loading: loadingMore,\n    variant: \"secondary\" // title=\"Load More\"\n    // intlButtonId=\"loadMoreBtn\"\n    // size=\"small\"\n    // isLoading={loadingMore}\n    // loader={<Loader color=\"#009E7F\" />}\n    // style={{\n    //   minWidth: 135,\n    //   backgroundColor: '#ffffff',\n    ,\n    border: \"1px solid #f1f1f1\" //   color: '#009E7F',\n    // }}\n    ,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 11\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"loadMoreButton\",\n    defaultMessage: \"Load More\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 13\n    }\n  }))));\n};\n\n_s(Products, \"ueba3JWNO7pCfJpEXFd18E8kiNE=\", false, function () {\n  return [useRouter, useQuery];\n});\n\n_c = Products;\nexport default Products;\n\nvar _c;\n\n$RefreshReg$(_c, \"Products\");","map":{"version":3,"sources":["/Users/virginiamuruzabal/work/ditto/client/packages/shop/src/components/product-grid/product-list-two/product-list-two.tsx"],"names":["React","useState","useRouter","FoodCard","ProductsRow","ProductsCol","ButtonWrapper","LoaderWrapper","LoaderItem","ProductCardWrapper","useQuery","Button","Placeholder","Fade","NoResultFound","customerDistance","formatTime","FormattedMessage","GET_VENDORS","Products","deviceType","type","fetchLimit","loadMore","router","loadingMore","toggleLoading","variables","text","query","category","offset","limit","data","error","loading","fetchMore","message","vendors","items","length","handleLoadMore","Number","updateQuery","prev","fetchMoreResult","__typename","totalCount","hasMore","map","item","index","height","name","thumbnailUrl","categories","join","deliveryDetails","charge","isFree","promotion","push","slug"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { useRouter } from 'next/router';\nimport gql from 'graphql-tag';\nimport FoodCard from 'components/product-card/product-card-four/product-card-four';\nimport {\n  ProductsRow,\n  ProductsCol,\n  ButtonWrapper,\n  LoaderWrapper,\n  LoaderItem,\n  ProductCardWrapper,\n} from '../product-list/product-list.style';\nimport { useQuery } from '@apollo/react-hooks';\nimport { Button } from 'components/button/button';\nimport Placeholder from 'components/placeholder/placeholder';\nimport Fade from 'react-reveal/Fade';\nimport NoResultFound from 'components/no-result/no-result';\n\nimport { customerDistance } from 'utils/customerDistance';\nimport { formatTime } from 'utils/formatTime';\nimport { FormattedMessage } from 'react-intl';\nimport { GET_VENDORS } from 'graphql/query/vendors.query';\n\ntype ProductsProps = {\n  deviceType?: {\n    mobile: boolean;\n    tablet: boolean;\n    desktop: boolean;\n  };\n  type: string;\n  fetchLimit?: number;\n  loadMore?: boolean;\n};\nexport const Products: React.FC<ProductsProps> = ({\n  deviceType,\n  type,\n  fetchLimit = 26,\n  loadMore = true,\n}) => {\n  const router = useRouter();\n  const [loadingMore, toggleLoading] = useState(false);\n  const { data, error, loading, fetchMore } = useQuery(GET_VENDORS, {\n    variables: {\n      type: type,\n      text: router.query.text,\n      category: router.query.category,\n      offset: 0,\n      limit: fetchLimit,\n    },\n  });\n\n  if (loading) {\n    return (\n      <LoaderWrapper>\n        <LoaderItem>\n          <Placeholder uniqueKey=\"1\" />\n        </LoaderItem>\n        <LoaderItem>\n          <Placeholder uniqueKey=\"2\" />\n        </LoaderItem>\n        <LoaderItem>\n          <Placeholder uniqueKey=\"3\" />\n        </LoaderItem>\n      </LoaderWrapper>\n    );\n  }\n\n  if (error) return <div>{error.message}</div>;\n  if (!data || !data.vendors || data.vendors.items.length === 0) {\n    return <NoResultFound />;\n  }\n  const handleLoadMore = () => {\n    toggleLoading(true);\n    fetchMore({\n      variables: {\n        offset: Number(data.vendors.items.length),\n        limit: fetchLimit,\n      },\n      updateQuery: (prev, { fetchMoreResult }) => {\n        toggleLoading(false);\n        if (!fetchMoreResult) {\n          return prev;\n        }\n        return {\n          vendors: {\n            __typename: prev.vendors.__typename,\n            items: [...prev.vendors.items, ...fetchMoreResult.vendors.items],\n            totalCount: fetchMoreResult.vendors.totalCount,\n            hasMore: fetchMoreResult.vendors.hasMore,\n          },\n        };\n      },\n    });\n  };\n\n  return (\n    <>\n      <ProductsRow>\n        {data?.vendors?.items.map((item: any, index: number) => (\n          <ProductsCol key={index} className=\"food-col\">\n            <ProductCardWrapper>\n              <Fade\n                duration={800}\n                delay={index * 10}\n                style={{ height: '100%' }}\n              >\n                <FoodCard\n                  name={item.name}\n                  image={item.thumbnailUrl}\n                  restaurantType={item?.categories.join(', ')}\n                  duration={formatTime(customerDistance())}\n                  delivery={item.deliveryDetails.charge}\n                  isFree={item.deliveryDetails.isFree}\n                  discountInPercent={item.promotion}\n                  data={item}\n                  onClick={() =>\n                    router.push(\n                      '/restaurant/[slug]',\n                      `/restaurant/${item.slug}`\n                    )\n                  }\n                />\n              </Fade>\n            </ProductCardWrapper>\n          </ProductsCol>\n        ))}\n      </ProductsRow>\n      {loadMore && data.vendors.hasMore && (\n        <ButtonWrapper>\n          <Button\n            onClick={handleLoadMore}\n            loading={loadingMore}\n            variant=\"secondary\"\n            // title=\"Load More\"\n            // intlButtonId=\"loadMoreBtn\"\n            // size=\"small\"\n            // isLoading={loadingMore}\n            // loader={<Loader color=\"#009E7F\" />}\n            // style={{\n            //   minWidth: 135,\n            //   backgroundColor: '#ffffff',\n            border=\"1px solid #f1f1f1\"\n            //   color: '#009E7F',\n            // }}\n          >\n            <FormattedMessage id=\"loadMoreButton\" defaultMessage=\"Load More\" />\n          </Button>\n        </ButtonWrapper>\n      )}\n    </>\n  );\n};\nexport default Products;\n"]},"metadata":{},"sourceType":"module"}