{"ast":null,"code":"var _jsxFileName = \"/Users/estebanmuruzabal/work/ditto/client/packages/shop/src/pages/[type].tsx\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from 'react';\nimport dynamic from 'next/dynamic';\nimport { useRouter } from 'next/router';\nimport { Modal } from '@redq/reuse-modal';\nimport { useQuery } from '@apollo/react-hooks';\nimport { Banner } from 'components/banner/banner';\nimport { MainContentArea, SidebarSection, ContentSection, MobileCarouselDropdown } from 'assets/styles/pages.style'; // Static Data Import Here\n\nimport { sitePages } from 'site-settings/site-pages';\nimport { SEO } from 'components/seo';\nimport { useRefScroll } from 'utils/use-ref-scroll';\nimport { initializeApollo } from 'utils/apollo';\nimport { GET_PRODUCTS } from 'graphql/query/products.query';\nimport { GET_CATEGORIES } from 'graphql/query/category.query';\nimport { GET_TYPE } from 'graphql/query/type.query';\nimport { GET_TYPE_HOMECARDS } from 'graphql/query/type.homecards.query';\nimport ErrorMessage from 'components/error-message/error-message';\nimport { SHOP_IMAGE_HOST } from 'utils/images-path';\nimport { useIntl } from 'react-intl';\nimport { useLocale } from 'contexts/language/language.provider';\nconst Sidebar = dynamic(() => import('layouts/sidebar/sidebar'), {\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('layouts/sidebar/sidebar')],\n    modules: ['layouts/sidebar/sidebar']\n  }\n});\nconst Products = dynamic(() => import('components/product-grid/product-list/product-list'), {\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('components/product-grid/product-list/product-list')],\n    modules: ['components/product-grid/product-list/product-list']\n  }\n});\nconst CartPopUp = dynamic(() => import('features/carts/cart-popup'), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('features/carts/cart-popup')],\n    modules: ['features/carts/cart-popup']\n  }\n});\n\nconst CategoryPage = ({\n  deviceType\n}) => {\n  const {\n    query\n  } = useRouter();\n  const router = useRouter();\n  const {\n    locale,\n    changeLanguage\n  } = useLocale();\n  const intl = useIntl();\n  const PAGE_TYPE = query.type;\n  const page = sitePages[PAGE_TYPE];\n  const OPEN_CAGE_KEY = process.env.OPEN_CAGE_KEY;\n  const {\n    0: location,\n    1: setLocation\n  } = useState('');\n  const {\n    data: categoriesData,\n    loading: categoriesLoading\n  } = useQuery(GET_CATEGORIES, {\n    variables: {\n      type: router.query.type\n    }\n  });\n  const {\n    elRef: targetRef,\n    scroll\n  } = useRefScroll({\n    percentOfElement: 0,\n    percentOfContainer: 0,\n    offsetPX: -110\n  });\n  React.useEffect(() => {\n    if (query.text || query.category) {\n      scroll();\n    }\n  }, [query.text, query.category]);\n  React.useEffect(() => {\n    console.log(locale, location);\n    setLocateBasedOnLocation();\n  }, [locale, location]);\n  useEffect(() => {\n    if (navigator.geolocation) {\n      navigator.permissions.query({\n        name: \"geolocation\"\n      }).then(function (result) {\n        console.log(result);\n\n        if (result.state === \"granted\") {\n          //If granted then you can directly call your function here\n          navigator.geolocation.getCurrentPosition(success, errors, options);\n        } else if (result.state === \"prompt\") {\n          //If prompt then the user will be asked to give permission\n          navigator.geolocation.getCurrentPosition(success, errors, options);\n        } else if (result.state === \"denied\") {//If denied then you have to show instructions to enable location\n        }\n      });\n    } else {\n      console.log(\"Geolocation is not supported by this browser.\");\n    }\n  }, []);\n\n  function getLocationInfo(latitude, longitude) {\n    const url = `https://api.opencagedata.com/geocode/v1/json?q=${latitude},${longitude}&key=9224762c77b8486bb04d32f036690d2f`;\n    fetch(url).then(response => response.json()).then(data => {\n      console.log(data);\n\n      if (data.status.code === 200) {\n        console.log(\"results:\", data.results);\n        setLocation(data.results[0].formatted);\n      } else {\n        console.log(\"Reverse geolocation request failed.\");\n      }\n    }).catch(error => console.error(error));\n  }\n\n  var options = {\n    enableHighAccuracy: true,\n    timeout: 5000,\n    maximumAge: 0\n  };\n\n  function success(pos) {\n    var crd = pos.coords; // console.log(\"Your current position is:\");\n    // console.log(`Latitude : ${crd.latitude}`);\n    // console.log(`Longitude: ${crd.longitude}`);\n    // console.log(`More or less ${crd.accuracy} meters.`);\n\n    getLocationInfo(crd.latitude, crd.longitude);\n  }\n\n  function errors(err) {\n    console.warn(`ERROR(${err.code}): ${err.message}`);\n  }\n\n  const setLocateBasedOnLocation = () => {\n    if (!location) return;\n\n    switch (location.toLowerCase().includes('united states')) {\n      case value:\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  const {\n    data: homeCardsData,\n    loading: homeCardsLoading,\n    error: homeCardsError\n  } = useQuery(GET_TYPE_HOMECARDS, {\n    variables: {\n      type: PAGE_TYPE\n    }\n  });\n  const {\n    data,\n    loading,\n    error\n  } = useQuery(GET_TYPE, {\n    variables: {\n      searchText: PAGE_TYPE\n    }\n  });\n\n  if (loading || homeCardsLoading) {\n    return __jsx(ErrorMessage, {\n      message: intl.formatMessage({\n        id: 'loading',\n        defaultMessage: 'Cargando...'\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 12\n      }\n    });\n  }\n\n  ;\n\n  if (error || homeCardsError) {\n    return error ? __jsx(ErrorMessage, {\n      message: error.message,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 11\n      }\n    }) : __jsx(ErrorMessage, {\n      message: homeCardsError.message,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 11\n      }\n    });\n  }\n\n  ;\n  const {\n    home_title,\n    home_subtitle,\n    image\n  } = data.types.items.find(item => item.slug === router.query.type);\n  return __jsx(React.Fragment, null, __jsx(SEO, {\n    title: home_title,\n    description: home_subtitle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }\n  }), __jsx(Modal, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }\n  }, __jsx(Banner, {\n    intlTitleId: home_title,\n    intlDescriptionId: home_subtitle,\n    imageUrl: SHOP_IMAGE_HOST + image,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 9\n    }\n  }), __jsx(MobileCarouselDropdown, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 9\n    }\n  }, __jsx(Sidebar, {\n    type: PAGE_TYPE,\n    deviceType: deviceType,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 11\n    }\n  })), __jsx(MainContentArea, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 9\n    }\n  }, __jsx(SidebarSection, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 11\n    }\n  }, __jsx(Sidebar, {\n    type: PAGE_TYPE,\n    deviceType: deviceType,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 13\n    }\n  })), __jsx(ContentSection, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    ref: targetRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 13\n    }\n  }, __jsx(Products, {\n    type: PAGE_TYPE,\n    deviceType: deviceType,\n    fetchLimit: 25,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 15\n    }\n  })))), __jsx(CartPopUp, {\n    deviceType: deviceType,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport const getStaticProps = async ({\n  params\n}) => {\n  const apolloClient = initializeApollo();\n  await apolloClient.query({\n    query: GET_PRODUCTS,\n    variables: {\n      type: params.type,\n      offset: 0,\n      limit: 20\n    }\n  });\n  await apolloClient.query({\n    query: GET_CATEGORIES,\n    variables: {\n      type: params.type\n    }\n  });\n  return {\n    props: {\n      initialApolloState: apolloClient.cache.extract()\n    },\n    unstable_revalidate: 1\n  };\n};\nexport async function getStaticPaths() {\n  const apolloClient = initializeApollo();\n  const res = await apolloClient.query({\n    query: GET_TYPE,\n    variables: {\n      searchText: ''\n    }\n  });\n  const paths = res.data.types.items.map(item => {\n    return {\n      params: {\n        type: item.slug\n      }\n    };\n  });\n  return {\n    paths,\n    fallback: false\n  };\n}\nexport default CategoryPage;","map":{"version":3,"sources":["/Users/estebanmuruzabal/work/ditto/client/packages/shop/src/pages/[type].tsx"],"names":["React","useEffect","useState","dynamic","useRouter","Modal","useQuery","Banner","MainContentArea","SidebarSection","ContentSection","MobileCarouselDropdown","sitePages","SEO","useRefScroll","initializeApollo","GET_PRODUCTS","GET_CATEGORIES","GET_TYPE","GET_TYPE_HOMECARDS","ErrorMessage","SHOP_IMAGE_HOST","useIntl","useLocale","Sidebar","Products","CartPopUp","ssr","CategoryPage","deviceType","query","router","locale","changeLanguage","intl","PAGE_TYPE","type","page","OPEN_CAGE_KEY","process","env","location","setLocation","data","categoriesData","loading","categoriesLoading","variables","elRef","targetRef","scroll","percentOfElement","percentOfContainer","offsetPX","text","category","console","log","setLocateBasedOnLocation","navigator","geolocation","permissions","name","then","result","state","getCurrentPosition","success","errors","options","getLocationInfo","latitude","longitude","url","fetch","response","json","status","code","results","formatted","catch","error","enableHighAccuracy","timeout","maximumAge","pos","crd","coords","err","warn","message","toLowerCase","includes","value","homeCardsData","homeCardsLoading","homeCardsError","searchText","formatMessage","id","defaultMessage","home_title","home_subtitle","image","types","items","find","item","slug","getStaticProps","params","apolloClient","offset","limit","props","initialApolloState","cache","extract","unstable_revalidate","getStaticPaths","res","paths","map","fallback"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { GetStaticProps } from 'next';\nimport dynamic from 'next/dynamic';\nimport { useRouter } from 'next/router';\nimport { Modal } from '@redq/reuse-modal';\nimport { useQuery } from '@apollo/react-hooks';\nimport StoreNav from 'components/store-nav/store-nav';\nimport HomeCardsCarousel from 'components/carousel/homecards-carousel';\nimport { Banner } from 'components/banner/banner';\nimport {\n  MainContentArea,\n  SidebarSection,\n  ContentSection,\n  OfferSection,\n  MobileCarouselDropdown,\n} from 'assets/styles/pages.style';\n// Static Data Import Here\nimport { siteOffers } from 'site-settings/site-offers';\nimport { sitePages } from 'site-settings/site-pages';\nimport { SEO } from 'components/seo';\nimport { useRefScroll } from 'utils/use-ref-scroll';\nimport { initializeApollo } from 'utils/apollo';\nimport { GET_PRODUCTS } from 'graphql/query/products.query';\nimport { GET_CATEGORIES } from 'graphql/query/category.query';\nimport { GET_TYPE } from 'graphql/query/type.query';\nimport { GET_TYPE_HOMECARDS } from 'graphql/query/type.homecards.query';\nimport { CATEGORY_MENU_ITEMS } from 'site-settings/site-navigation';\nimport ErrorMessage from 'components/error-message/error-message';\nimport { OPEN_CAGE_KEY, SHOP_IMAGE_HOST } from 'utils/images-path';\nimport { useIntl } from 'react-intl';\nimport { useLocale } from 'contexts/language/language.provider';\nconst Sidebar = dynamic(() => import('layouts/sidebar/sidebar'));\nconst Products = dynamic(() =>\n  import('components/product-grid/product-list/product-list')\n);\nconst CartPopUp = dynamic(() => import('features/carts/cart-popup'), {\n  ssr: false,\n});\n\nconst CategoryPage: React.FC<any> = ({ deviceType }) => {\n  const { query } = useRouter();\n  const router = useRouter();\n  const { locale, changeLanguage } = useLocale();\n  const intl = useIntl();\n  const PAGE_TYPE: any = query.type;\n  const page = sitePages[PAGE_TYPE];\n  const OPEN_CAGE_KEY = process.env.OPEN_CAGE_KEY;\n  const [location, setLocation] = useState('');\n  \n  const { data: categoriesData, loading: categoriesLoading } = useQuery(GET_CATEGORIES, {\n    variables: { \n     type: router.query.type\n     },\n  });\n\n  const { elRef: targetRef, scroll } = useRefScroll({\n    percentOfElement: 0,\n    percentOfContainer: 0,\n    offsetPX: -110,\n  });\n\n  React.useEffect(() => {\n    if (query.text || query.category) {\n      scroll();\n    }\n  }, [query.text, query.category]);\n\n  React.useEffect(() => {\n    console.log(locale, location)\n    setLocateBasedOnLocation()\n  }, [locale, location]);\n\n  useEffect(() => {\n    if (navigator.geolocation) {\n      navigator.permissions\n        .query({ name: \"geolocation\" })\n        .then(function (result) {\n          console.log(result);\n          if (result.state === \"granted\") {\n            //If granted then you can directly call your function here\n            navigator.geolocation.getCurrentPosition(success, errors, options);\n          } else if (result.state === \"prompt\") {\n            //If prompt then the user will be asked to give permission\n            navigator.geolocation.getCurrentPosition(success, errors, options);\n          } else if (result.state === \"denied\") {\n            //If denied then you have to show instructions to enable location\n          }\n        });\n    } else {\n      console.log(\"Geolocation is not supported by this browser.\");\n    }\n  }, []);\n  \n  function getLocationInfo(latitude, longitude) {\n    const url = `https://api.opencagedata.com/geocode/v1/json?q=${latitude},${longitude}&key=9224762c77b8486bb04d32f036690d2f`;\n    fetch(url)\n      .then((response) => response.json())\n      .then((data) => {\n        console.log(data);\n        if (data.status.code === 200) {\n\n          console.log(\"results:\", data.results);\n          setLocation(data.results[0].formatted);\n        } else {\n          console.log(\"Reverse geolocation request failed.\");\n        }\n      })\n      .catch((error) => console.error(error));\n  }\n  var options = {\n    enableHighAccuracy: true,\n    timeout: 5000,\n    maximumAge: 0,\n  };\n  function success(pos) {\n    var crd = pos.coords;\n    // console.log(\"Your current position is:\");\n    // console.log(`Latitude : ${crd.latitude}`);\n    // console.log(`Longitude: ${crd.longitude}`);\n    // console.log(`More or less ${crd.accuracy} meters.`);\n    \n    getLocationInfo(crd.latitude, crd.longitude);\n  }\n\n  function errors(err) { console.warn(`ERROR(${err.code}): ${err.message}`); }\n\n  const setLocateBasedOnLocation = () => {\n    if (!location) return;\n    switch (location.toLowerCase().includes('united states')) {\n      case value:\n        \n        break;\n    \n      default:\n        break;\n    }\n  }\n\n  const { data: homeCardsData, loading: homeCardsLoading, error: homeCardsError } = useQuery(GET_TYPE_HOMECARDS, {\n    variables: { \n      type: PAGE_TYPE\n     },\n  });\n\n  const { data, loading, error } = useQuery(GET_TYPE, {\n    variables: {\n      searchText: PAGE_TYPE\n     },\n  });\n\n\n  if (loading || homeCardsLoading) {\n    return <ErrorMessage message={intl.formatMessage({ id: 'loading', defaultMessage: 'Cargando...' })} />\n  };\n\n  if (error || homeCardsError) {\n    return (\n      error ? (\n          <ErrorMessage message={error.message} />\n      ) : (\n          <ErrorMessage message={homeCardsError.message} />\n      )\n    );\n  };\n\n  const { home_title, home_subtitle, image } = data.types.items.find((item) => item.slug === router.query.type);\n\n  return (\n    <>\n      <SEO title={home_title} description={home_subtitle} />\n\n      <Modal>\n        <Banner\n          intlTitleId={home_title}\n          intlDescriptionId={home_subtitle}\n          imageUrl={SHOP_IMAGE_HOST+image}\n        />\n        <MobileCarouselDropdown>\n          {/* if wanna show categories, fix the component to display them */}\n          {/* <StoreNav items={categoriesData.categories.items} />  */}\n          <Sidebar type={PAGE_TYPE} deviceType={deviceType} />\n        </MobileCarouselDropdown>\n        {/* {homeCardsData.getHomeCards.length > 0 ? (<OfferSection>\n          <div style={{margin: '0 -10px'}}>\n            <HomeCardsCarousel deviceType={deviceType} data={homeCardsData.getHomeCards}/>\n          </div>\n        </OfferSection>) : (<div></div>)\n        } */}\n        <MainContentArea>\n          <SidebarSection>\n            <Sidebar type={PAGE_TYPE} deviceType={deviceType} />\n          </SidebarSection>\n          <ContentSection>\n            <div ref={targetRef}>\n              <Products\n                type={PAGE_TYPE}\n                deviceType={deviceType}\n                fetchLimit={25}\n              />\n            </div>\n          </ContentSection>\n        </MainContentArea>\n        <CartPopUp deviceType={deviceType} />\n      </Modal>\n    </>\n  );\n};\nexport const getStaticProps: GetStaticProps = async ({ params }) => {\n  const apolloClient = initializeApollo();\n\n  await apolloClient.query({\n    query: GET_PRODUCTS,\n    variables: {\n      type: params.type,\n      offset: 0,\n      limit: 20\n    },\n  });\n\n  await apolloClient.query({\n    query: GET_CATEGORIES,\n    variables: {\n      type: params.type,\n    },\n  });\n\n  return {\n    props: {\n      initialApolloState: apolloClient.cache.extract(),\n    },\n    unstable_revalidate: 1,\n  };\n};\n\nexport async function getStaticPaths() {\n\n  const apolloClient = initializeApollo();\n  const res = await apolloClient.query({\n    query: GET_TYPE,\n    variables: {\n      searchText: ''\n    }\n  });\n  const paths = res.data.types.items.map((item) => {\n    return({\n      params: { type: item.slug },\n    })\n  })\n\n  return {\n    paths,\n    fallback: false,\n  };\n}\n\nexport default CategoryPage;\n"]},"metadata":{},"sourceType":"module"}